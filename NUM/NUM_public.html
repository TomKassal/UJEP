<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tomáš Kassal, Martin Kuchař">

<title>Numerické metody</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="NUM_public_files/libs/clipboard/clipboard.min.js"></script>
<script src="NUM_public_files/libs/quarto-html/quarto.js"></script>
<script src="NUM_public_files/libs/quarto-html/popper.min.js"></script>
<script src="NUM_public_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="NUM_public_files/libs/quarto-html/anchor.min.js"></script>
<link href="NUM_public_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="NUM_public_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="NUM_public_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="NUM_public_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="NUM_public_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Obsah</h2>
   
  <ul>
  <li><a href="#zavedení-základních-pojmů" id="toc-zavedení-základních-pojmů" class="nav-link active" data-scroll-target="#zavedení-základních-pojmů"><span class="header-section-number">1</span> Zavedení základních pojmů</a>
  <ul class="collapse">
  <li><a href="#polynom" id="toc-polynom" class="nav-link" data-scroll-target="#polynom"><span class="header-section-number">1.1</span> Polynom</a></li>
  <li><a href="#limita" id="toc-limita" class="nav-link" data-scroll-target="#limita"><span class="header-section-number">1.2</span> Limita</a></li>
  <li><a href="#derivace" id="toc-derivace" class="nav-link" data-scroll-target="#derivace"><span class="header-section-number">1.3</span> Derivace</a></li>
  <li><a href="#integrál" id="toc-integrál" class="nav-link" data-scroll-target="#integrál"><span class="header-section-number">1.4</span> Integrál</a></li>
  </ul></li>
  <li><a href="#řešení-nelineárních-rovnic" id="toc-řešení-nelineárních-rovnic" class="nav-link" data-scroll-target="#řešení-nelineárních-rovnic"><span class="header-section-number">2</span> Řešení nelineárních rovnic</a>
  <ul class="collapse">
  <li><a href="#volba-funkce-vhodné-pro-aplikování-metod" id="toc-volba-funkce-vhodné-pro-aplikování-metod" class="nav-link" data-scroll-target="#volba-funkce-vhodné-pro-aplikování-metod"><span class="header-section-number">2.1</span> Volba funkce vhodné pro aplikování metod</a></li>
  <li><a href="#metoda-půlení-intervalu-bisekce" id="toc-metoda-půlení-intervalu-bisekce" class="nav-link" data-scroll-target="#metoda-půlení-intervalu-bisekce"><span class="header-section-number">2.2</span> Metoda půlení intervalu (bisekce)</a>
  <ul class="collapse">
  <li><a href="#metoda-půlení-intervalu-v-jazyce-r" id="toc-metoda-půlení-intervalu-v-jazyce-r" class="nav-link" data-scroll-target="#metoda-půlení-intervalu-v-jazyce-r">Metoda půlení intervalu v jazyce R</a></li>
  </ul></li>
  <li><a href="#metoda-regula-falsi" id="toc-metoda-regula-falsi" class="nav-link" data-scroll-target="#metoda-regula-falsi"><span class="header-section-number">2.3</span> Metoda regula falsi</a>
  <ul class="collapse">
  <li><a href="#metoda-regula-falsi-v-jazyce-r" id="toc-metoda-regula-falsi-v-jazyce-r" class="nav-link" data-scroll-target="#metoda-regula-falsi-v-jazyce-r">Metoda regula falsi v jazyce R</a></li>
  </ul></li>
  <li><a href="#newtonova-metoda-tečen" id="toc-newtonova-metoda-tečen" class="nav-link" data-scroll-target="#newtonova-metoda-tečen"><span class="header-section-number">2.4</span> Newtonova metoda tečen</a>
  <ul class="collapse">
  <li><a href="#newtonova-metoda-tečen-v-jazyce-r" id="toc-newtonova-metoda-tečen-v-jazyce-r" class="nav-link" data-scroll-target="#newtonova-metoda-tečen-v-jazyce-r">Newtonova metoda tečen v jazyce R</a></li>
  </ul></li>
  <li><a href="#steffensenova-metoda" id="toc-steffensenova-metoda" class="nav-link" data-scroll-target="#steffensenova-metoda"><span class="header-section-number">2.5</span> Steffensenova metoda</a>
  <ul class="collapse">
  <li><a href="#steffensenova-metoda-v-jazyce-r" id="toc-steffensenova-metoda-v-jazyce-r" class="nav-link" data-scroll-target="#steffensenova-metoda-v-jazyce-r">Steffensenova metoda v jazyce R</a></li>
  </ul></li>
  <li><a href="#halleyova-metoda" id="toc-halleyova-metoda" class="nav-link" data-scroll-target="#halleyova-metoda"><span class="header-section-number">2.6</span> Halleyova metoda</a>
  <ul class="collapse">
  <li><a href="#halleyova-metoda-v-jazyce-r" id="toc-halleyova-metoda-v-jazyce-r" class="nav-link" data-scroll-target="#halleyova-metoda-v-jazyce-r">Halleyova metoda v jazyce R</a></li>
  </ul></li>
  <li><a href="#fixed-point-iteration" id="toc-fixed-point-iteration" class="nav-link" data-scroll-target="#fixed-point-iteration"><span class="header-section-number">2.7</span> Fixed-point iteration</a>
  <ul class="collapse">
  <li><a href="#fixed-point-iteration-v-jazyce-r" id="toc-fixed-point-iteration-v-jazyce-r" class="nav-link" data-scroll-target="#fixed-point-iteration-v-jazyce-r">Fixed-point iteration v jazyce R</a></li>
  </ul></li>
  <li><a href="#newtonova-hornerova-metoda" id="toc-newtonova-hornerova-metoda" class="nav-link" data-scroll-target="#newtonova-hornerova-metoda"><span class="header-section-number">2.8</span> Newtonova-Hornerova metoda</a>
  <ul class="collapse">
  <li><a href="#hornerovo-schéma" id="toc-hornerovo-schéma" class="nav-link" data-scroll-target="#hornerovo-schéma">Hornerovo schéma</a></li>
  <li><a href="#newtonova-hornerova-metoda-v-jazyce-r" id="toc-newtonova-hornerova-metoda-v-jazyce-r" class="nav-link" data-scroll-target="#newtonova-hornerova-metoda-v-jazyce-r">Newtonova-Hornerova metoda v jazyce R</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#řešení-soustav-lineárních-rovnic" id="toc-řešení-soustav-lineárních-rovnic" class="nav-link" data-scroll-target="#řešení-soustav-lineárních-rovnic"><span class="header-section-number">3</span> Řešení soustav lineárních rovnic</a>
  <ul class="collapse">
  <li><a href="#volba-vhodné-soustavy-k-řešení" id="toc-volba-vhodné-soustavy-k-řešení" class="nav-link" data-scroll-target="#volba-vhodné-soustavy-k-řešení"><span class="header-section-number">3.1</span> Volba vhodné soustavy k řešení</a></li>
  <li><a href="#gaussova-eliminační-metoda" id="toc-gaussova-eliminační-metoda" class="nav-link" data-scroll-target="#gaussova-eliminační-metoda"><span class="header-section-number">3.2</span> Gaussova eliminační metoda</a>
  <ul class="collapse">
  <li><a href="#gaussova-eliminační-metoda-v-jazyce-r" id="toc-gaussova-eliminační-metoda-v-jazyce-r" class="nav-link" data-scroll-target="#gaussova-eliminační-metoda-v-jazyce-r">Gaussova eliminační metoda v jazyce R</a></li>
  </ul></li>
  <li><a href="#metoda-lu-rozkladu" id="toc-metoda-lu-rozkladu" class="nav-link" data-scroll-target="#metoda-lu-rozkladu"><span class="header-section-number">3.3</span> Metoda LU rozkladu</a>
  <ul class="collapse">
  <li><a href="#zjištění-lu-rozkladu-při-přímém-chodu-gaussovy-eliminační-metody-na-příkladu" id="toc-zjištění-lu-rozkladu-při-přímém-chodu-gaussovy-eliminační-metody-na-příkladu" class="nav-link" data-scroll-target="#zjištění-lu-rozkladu-při-přímém-chodu-gaussovy-eliminační-metody-na-příkladu">Zjištění LU rozkladu při přímém chodu Gaussovy eliminační metody na příkladu</a></li>
  <li><a href="#metoda-lu-rozkladu-v-jazyce-r" id="toc-metoda-lu-rozkladu-v-jazyce-r" class="nav-link" data-scroll-target="#metoda-lu-rozkladu-v-jazyce-r">Metoda LU rozkladu v jazyce R</a></li>
  </ul></li>
  <li><a href="#jacobiho-metoda" id="toc-jacobiho-metoda" class="nav-link" data-scroll-target="#jacobiho-metoda"><span class="header-section-number">3.4</span> Jacobiho metoda</a>
  <ul class="collapse">
  <li><a href="#jacobiho-metoda-v-jazyce-r" id="toc-jacobiho-metoda-v-jazyce-r" class="nav-link" data-scroll-target="#jacobiho-metoda-v-jazyce-r">Jacobiho metoda v jazyce R</a></li>
  </ul></li>
  <li><a href="#gaussova-seidelova-metoda" id="toc-gaussova-seidelova-metoda" class="nav-link" data-scroll-target="#gaussova-seidelova-metoda"><span class="header-section-number">3.5</span> Gaussova-Seidelova metoda</a>
  <ul class="collapse">
  <li><a href="#gaussova-seidelova-metoda-v-jazyce-r" id="toc-gaussova-seidelova-metoda-v-jazyce-r" class="nav-link" data-scroll-target="#gaussova-seidelova-metoda-v-jazyce-r">Gaussova-Seidelova metoda v jazyce R</a></li>
  </ul></li>
  <li><a href="#rozdíl-mezi-jacobiho-a-gaussovou-seidelovou-metodou" id="toc-rozdíl-mezi-jacobiho-a-gaussovou-seidelovou-metodou" class="nav-link" data-scroll-target="#rozdíl-mezi-jacobiho-a-gaussovou-seidelovou-metodou"><span class="header-section-number">3.6</span> Rozdíl mezi Jacobiho a Gaussovou-Seidelovou metodou</a></li>
  </ul></li>
  <li><a href="#interpolace" id="toc-interpolace" class="nav-link" data-scroll-target="#interpolace"><span class="header-section-number">4</span> Interpolace</a>
  <ul class="collapse">
  <li><a href="#volba-bodů-k-interpolaci" id="toc-volba-bodů-k-interpolaci" class="nav-link" data-scroll-target="#volba-bodů-k-interpolaci"><span class="header-section-number">4.1</span> Volba bodů k interpolaci</a></li>
  <li><a href="#lineární-interpolace-po-částech" id="toc-lineární-interpolace-po-částech" class="nav-link" data-scroll-target="#lineární-interpolace-po-částech"><span class="header-section-number">4.2</span> Lineární interpolace po částech</a>
  <ul class="collapse">
  <li><a href="#lineární-interpolace-po-částech-v-jazyce-r" id="toc-lineární-interpolace-po-částech-v-jazyce-r" class="nav-link" data-scroll-target="#lineární-interpolace-po-částech-v-jazyce-r">Lineární interpolace po částech v jazyce R</a></li>
  </ul></li>
  <li><a href="#interpolace-polynomem-v-lagrangeově-tvaru" id="toc-interpolace-polynomem-v-lagrangeově-tvaru" class="nav-link" data-scroll-target="#interpolace-polynomem-v-lagrangeově-tvaru"><span class="header-section-number">4.3</span> Interpolace polynomem v Lagrangeově tvaru</a>
  <ul class="collapse">
  <li><a href="#lagrangeův-interpolační-polynom-v-jazyce-r" id="toc-lagrangeův-interpolační-polynom-v-jazyce-r" class="nav-link" data-scroll-target="#lagrangeův-interpolační-polynom-v-jazyce-r">Lagrangeův interpolační polynom v jazyce R</a></li>
  </ul></li>
  <li><a href="#interpolace-polynomem-v-newtonově-tvaru" id="toc-interpolace-polynomem-v-newtonově-tvaru" class="nav-link" data-scroll-target="#interpolace-polynomem-v-newtonově-tvaru"><span class="header-section-number">4.4</span> Interpolace polynomem v Newtonově tvaru</a>
  <ul class="collapse">
  <li><a href="#newtonův-interpolační-polynom-v-jazyce-r" id="toc-newtonův-interpolační-polynom-v-jazyce-r" class="nav-link" data-scroll-target="#newtonův-interpolační-polynom-v-jazyce-r">Newtonův interpolační polynom v jazyce R</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#aproximace-metodou-nejmenších-čtverců" id="toc-aproximace-metodou-nejmenších-čtverců" class="nav-link" data-scroll-target="#aproximace-metodou-nejmenších-čtverců"><span class="header-section-number">5</span> Aproximace metodou nejmenších čtverců</a></li>
  <li><a href="#numerické-derivování-a-integrace" id="toc-numerické-derivování-a-integrace" class="nav-link" data-scroll-target="#numerické-derivování-a-integrace"><span class="header-section-number">6</span> Numerické derivování a integrace</a>
  <ul class="collapse">
  <li><a href="#newtonovy-cotesovy-vzorce" id="toc-newtonovy-cotesovy-vzorce" class="nav-link" data-scroll-target="#newtonovy-cotesovy-vzorce"><span class="header-section-number">6.1</span> Newtonovy-Cotesovy vzorce</a></li>
  <li><a href="#rombergova-kvadratura" id="toc-rombergova-kvadratura" class="nav-link" data-scroll-target="#rombergova-kvadratura"><span class="header-section-number">6.2</span> Rombergova kvadratura</a></li>
  </ul></li>
  <li><a href="#numerické-řešení-obyčejných-diferenciálních-rovnic" id="toc-numerické-řešení-obyčejných-diferenciálních-rovnic" class="nav-link" data-scroll-target="#numerické-řešení-obyčejných-diferenciálních-rovnic"><span class="header-section-number">7</span> Numerické řešení obyčejných diferenciálních rovnic</a>
  <ul class="collapse">
  <li><a href="#eulerova-metoda" id="toc-eulerova-metoda" class="nav-link" data-scroll-target="#eulerova-metoda"><span class="header-section-number">7.1</span> Eulerova metoda</a></li>
  <li><a href="#metody-rungeho-kutty" id="toc-metody-rungeho-kutty" class="nav-link" data-scroll-target="#metody-rungeho-kutty"><span class="header-section-number">7.2</span> Metody Rungeho-Kutty</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Numerické metody</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tomáš Kassal, Martin Kuchař </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="zavedení-základních-pojmů" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Zavedení základních pojmů</h1>
<p>Před rozborem jednotlivých metod je potřeba si zopakovat základní pojmy z kurzu Matematika I.</p>
<section id="polynom" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="polynom"><span class="header-section-number">1.1</span> Polynom</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace včetně příkladů naleznete v učebním materiálu:</p>
<ul>
<li><a href="https://math.fel.cvut.cz/mt/txtb/4/txc3ba4b.htm">Polynomy a racionální funkce</a>.</li>
</ul>
</div>
</div>
</div>
<p>Připomeňme si tvar, ve kterém jste byli zvyklí polynom zapisovat. Libovolný polynom můžeme upravit na tvar <span class="math display">\[
a_nx^n + a_{n-1}x^{n-1} + \cdots \ a_1x + a_0,
\]</span> kde <span class="math inline">\(n \in \mathbb{N}\)</span> a <span class="math inline">\(a_0, a_1, \cdots, a_n \in \mathbb{R}\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definice polynomu
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pod pojmem polynom rozumíme libovolnou funkci ve tvaru <span class="math display">\[
p(x) = a_0 + a_1x + a_2x^2 + \cdots + a_nx^n,
\]</span> kde <span class="math inline">\(k \in \mathbb{N}\)</span> a <span class="math inline">\(a_k \in \mathbb{R}\)</span>.</p>
</div>
</div>
<p>U každého polynomu můžeme určit jeho stupeň, který je vymezen následující definicí.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definice stupně polynomu
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nechť <span class="math inline">\(p(x)\)</span> je polynom. Pak definujeme stupeň polynomu <span class="math inline">\(st(p)\)</span> takto: jestliže <span class="math inline">\(p = a_0 + a_1x + a_2x^2 + \cdots + a_nx^n\)</span> a <span class="math inline">\(a_n \neq 0\)</span>, pak <span class="math display">\[st(p) = n.\]</span></p>
</div>
</div>
</section>
<section id="limita" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="limita"><span class="header-section-number">1.2</span> Limita</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace včetně příkladů naleznete v učebním materiálu:</p>
<ul>
<li><a href="https://math.fel.cvut.cz/mt/txtb/5/txc3ba5a.htm">Definice limity</a>.</li>
</ul>
<p>Interaktivní vizualizaci limity včetně její definice naleznete zde:</p>
<ul>
<li><a href="https://www.geogebra.org/m/us8b5ufy">Limita a spojitost</a></li>
</ul>
</div>
</div>
</div>
<p>Na následujícím obrázku si vysvětlíme, proč je nástroj limity tak důležitý. Máme funkci <span class="math inline">\(f\)</span> s definičním oborem <span class="math inline">\(D(f) = \mathbb{R} \setminus \{a\}\)</span>.</p>
<div class="columns">
<div class="column" style="width:10%;">

</div><div class="column" style="width:80%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="motivace_limita.jpg" class="img-fluid figure-img"></p>
<figcaption>Motivace k vytvoření nástroje limity</figcaption>
</figure>
</div>
</div><div class="column" style="width:10%;">

</div>
</div>
<p>V bodě <span class="math inline">\(a\)</span> není funkce <span class="math inline">\(f\)</span> definována. Nicméně na základě naší vizualizace má smysl se ptát, k jakým hodnotám se blíží jednotlivé části funkce <span class="math inline">\(f\)</span>?</p>
<p>Funkce se bude zleva i zprava blížit stejné hodnotě. Tímto způsobem tak můžeme odstranit body, v nichž není funkce definována. Navíc je limita nástrojem, jak odhadnout chování v okolí daného bodu (včetně okrajů definičního oboru v <span class="math inline">\(\pm\infty\)</span>).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definice limity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Uvažujme funkci <span class="math inline">\(f\)</span> definovanou na nějakém prstencovém okolí bodu <span class="math inline">\(a\)</span>. Řekneme, že reálné číslo <span class="math inline">\(L\)</span> je <strong>limita</strong> funkce <span class="math inline">\(f\)</span> pro <span class="math inline">\(x\)</span> jdoucí k <span class="math inline">\(a\)</span>, nebo že funkce konverguje k tomuto <span class="math inline">\(L\)</span> pro <span class="math inline">\(x\)</span> jdoucí k <span class="math inline">\(a\)</span>, jestliže <span class="math display">\[
(\forall\; \epsilon &gt; 0) \;(\exists \;\delta &gt; 0)\;(\forall\; x\in \langle x-\delta;x+\delta \rangle\setminus \{x\});\; f(x) \in \langle L-\epsilon; L+\epsilon\rangle
\]</span> Značení je <span class="math display">\[\lim{f(x)}=L.\]</span></p>
<p>Můžeme také psát <span class="math inline">\(f \to L\)</span> pro <span class="math inline">\(x \to a\)</span>.</p>
<p>Pokud takové <span class="math inline">\(L\)</span> existuje, řekneme, že <span class="math inline">\(f\)</span> <strong>konverguje</strong> v <span class="math inline">\(a\)</span>, jinak řekneme, že <span class="math inline">\(f\)</span> <strong>diverguje</strong> v <span class="math inline">\(a\)</span>.</p>
</div>
</div>
</section>
<section id="derivace" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="derivace"><span class="header-section-number">1.3</span> Derivace</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace včetně příkladů naleznete v učebních materiálech:</p>
<ul>
<li><a href="http://fse.ujep.cz/~moc/ucebnice_matematiky.pdf">Matematika pro ekonomy</a> na straně 347,</li>
<li><a href="https://homel.vsb.cz/~s1a64/cd/pdf/dp/dp_obr.pdf">Diferenciální počet funkcí jedné proměnné</a> na stranách 338-341.</li>
</ul>
<p>Interaktivní vizualizace derivace:</p>
<ul>
<li><a href="https://www.geogebra.org/m/FDgZtVNx">Derivative - Limit Visualization</a></li>
</ul>
</div>
</div>
</div>
<section id="geometrický-význam-derivace" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="geometrický-význam-derivace">Geometrický význam derivace</h4>
<div class="columns">
<div class="column" style="width:10%;">

</div><div class="column" style="width:80%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="motivace_derivace.jpg" class="img-fluid figure-img"></p>
<figcaption>Derivace v geometrii</figcaption>
</figure>
</div>
</div><div class="column" style="width:10%;">

</div>
</div>
<p>Geometrická podstata derivace vychází z hledání směrnice tečny <span class="math inline">\(t\)</span> (na obrázku červeně). Co bez pochyb budeme umět najít je směrnice sečny <span class="math inline">\(s\)</span> (na obrázku modře), označme ji <span class="math inline">\(k\)</span>. Když se podíváme na obrázek, můžeme vyjádřit směrnici sečny takto <span class="math display">\[
\tan \beta = \frac{f(x)-f(x_0)}{x-x_0}.
\]</span> Nyní musíme využít limitní úvahy. Tečnu v bodě <span class="math inline">\(x_0\)</span> z této sečny dostaneme tak, že se bodem <span class="math inline">\(x\)</span> budeme přibližovat k bodu <span class="math inline">\(x\)</span>. <span class="math display">\[
\tan \beta = \lim_{x \to x_0} \frac{f(x)-f(x_0)}{x-x_0}
\]</span> Nyní si označme šířku mezi body na ose <span class="math inline">\(x\)</span> takto <span class="math inline">\(h = x-x_0\)</span>. Nyní upravme naší rovnici podle této substituce. Zároveň, přeznačíme limitu, jelikož chceme aby se šířka <span class="math inline">\(h\)</span> blížila 0. Tím již dostaneme tečnu a bude platit <span class="math inline">\(\alpha = \beta\)</span> <span class="math display">\[
\tan \alpha = \lim_{h \to 0} \frac{f(x_0 + h) - f(x_0)}{h}
\]</span> Nyní už jen stačí vzpomenout, že pro směrnici přímky <span class="math inline">\(k\)</span> platí, že <span class="math inline">\(k = \tan \alpha\)</span>. Dostáváme se tak k naší rovnici derivace <span class="math display">\[
k = \lim_{h\to 0} \frac{f(x_0 + h) - f(x_0)}{h}.
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definice derivace
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mějme dánu funkci <span class="math inline">\(f(x)\)</span>. Existuje-li limita <span class="math display">\[
\lim_{h\to0} \frac{f(a+h)-f(a)}{h},
\]</span> potom její hodnotu nazýváme <strong>derivací</strong> funkce <span class="math inline">\(f(x)\)</span> v bodě <span class="math inline">\(a\)</span> a značíme ji symbolem <span class="math inline">\(f'(a)\)</span>.</p>
</div>
</div>
</section>
</section>
<section id="integrál" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="integrál"><span class="header-section-number">1.4</span> Integrál</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace včetně obrázků naleznete v učebnici:</p>
<ul>
<li><a href="http://fse.ujep.cz/~moc/ucebnice_matematiky.pdf">Matematika pro ekonomy</a> na stranách 439 - 445.</li>
</ul>
<p>Interaktivní vizualizace určitého integrálu:</p>
<ul>
<li><a href="https://www.geogebra.org/m/tge9bpap">Definite Integral Calculator</a></li>
<li><a href="https://www.geogebra.org/m/myqgeegt">Approximating a Definite Integral from Graph</a></li>
</ul>
</div>
</div>
</div>
<p>Podstatou neurčitého itegrálu je nalezení primitivní funkce <span class="math inline">\(F(x)\)</span> k funkci <span class="math inline">\(f(x)\)</span>, neboli funkce, z níž po jejím zderivování dostaneme původní funkci. <span class="math display">\[
\int f(x) \, \mathrm{d}x = F(x)
\]</span> Musí pak platit <span class="math display">\[
F'(x) = f(x).
\]</span> Nicméně v numerických metodách se snažíme o vyčíslení integrálu, tedy o výpočet obsahu mezi funkcí <span class="math inline">\(f(x)\)</span> a osou <span class="math inline">\(x\)</span>. To znamená, že se budeme snažit o výpočet určitého integrálu na intervalu <span class="math inline">\(\langle a; b\rangle\)</span> <span class="math display">\[
\int_{a}^{b} f(x) \, \mathrm{d}x.
\]</span> K výpočtu určitého integrálu se používá následující věta.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Newton-Leibnizova věta
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nechť <span class="math inline">\(a&lt;b\)</span>, nechť <span class="math inline">\(\exists \int_{a}^{b} f(x)\)</span>, nechť <span class="math inline">\(F(x)\)</span> je funkce, která má tyto vlastnosti:</p>
<ol type="1">
<li>je spojitá na intervalu <span class="math inline">\(\langle a;b \rangle\)</span>,</li>
<li><span class="math inline">\(\forall x \in \langle a;b \rangle; \; F'(x) = f(x)\)</span>.</li>
</ol>
<p>Pak platí <span class="math display">\[
\int_{a}^{b} f(x) = F(b) - F(a).
\]</span></p>
</div>
</div>
</section>
</section>
<section id="řešení-nelineárních-rovnic" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Řešení nelineárních rovnic</h1>
<p>V této kapitole se snažíme o nalezení kořenů nelineárních rovnic, tj. hledáme bod, v němž platí <span class="math inline">\(f(x) = 0\)</span>, kde <span class="math inline">\(f\)</span> je funkce.</p>
<div class="columns">
<div class="column" style="width:25%;">

</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="motivace.jpg" class="img-fluid figure-img"></p>
<figcaption>Hledané body</figcaption>
</figure>
</div>
</div><div class="column" style="width:25%;">

</div>
</div>
<section id="volba-funkce-vhodné-pro-aplikování-metod" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="volba-funkce-vhodné-pro-aplikování-metod"><span class="header-section-number">2.1</span> Volba funkce vhodné pro aplikování metod</h2>
<p>Nejprve si zvolíme funkci, na níž budeme postupně představovat všechny metody řešení nelineárních rovnic. Zvolme funkci <span class="math display">\[
f(x) = x^3 - x - 2.
\]</span></p>
</section>
<section id="metoda-půlení-intervalu-bisekce" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="metoda-půlení-intervalu-bisekce"><span class="header-section-number">2.2</span> Metoda půlení intervalu (bisekce)</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace včetně příkladů naleznete v učebnicích:</p>
<ul>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/Numerika.pdf">Numerika</a> na stranách 36-38,</li>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/FINALNI_VERZE_CD.pdf">Numerické metody</a> na stranách 25-26.</li>
</ul>
<p>Interaktivní vizualizace metody:</p>
<ul>
<li><a href="https://www.geogebra.org/m/krEg2ew5">Numerické metody - půlení intervalu</a></li>
</ul>
</div>
</div>
</div>
<p>Metoda půlení intervalu je nejjednodušší z metod řešení nelineárních rovnic. Mějme spojitou funkci <span class="math inline">\(f\)</span> a interval <span class="math inline">\(\langle a, b \rangle\)</span>, pro který platí, že <span class="math inline">\(f(a) \cdot f(b) &lt; 0\)</span>. Z následující věty potom plyne existence alespoň jednoho kořene na tomto intervalu.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Věta
</div>
</div>
<div class="callout-body-container callout-body">
<p>Je-li funkce <span class="math inline">\(f\)</span> spojitá na intervalu <span class="math inline">\(\langle a, b \rangle\)</span> a platí-li <span class="math inline">\(f(a)f(b) &lt; 0\)</span>, pak v intervalu <span class="math inline">\(\langle a, b \rangle\)</span> leží alespoň jeden kořen rovnice <span class="math inline">\(f(x) = 0\)</span>.</p>
</div>
</div>
<p>Myšlenka této věty je jednoduchá - v krajních bodech intervalu jsou odlišná znaménka. Z předpokladu spojitosti pak plyne pochopitelný fakt, že funkce <span class="math inline">\(f\)</span> musí na tomto intervalu protnout osu <span class="math inline">\(x\)</span>.</p>
<p>Samotný výpočet kořene se nyní odvíjí od zužování intervalu, kdy vezmeme bod v polovině intervalu <span class="math inline">\(c = \frac{a+b}{2}\)</span> a zjistíme zda není kořenem rovnice. Pokud tomu tak není, zjistíme, který z dvou vzniklých intervalů splňuje podmínku <span class="math inline">\(f(a) \cdot f(b) &lt; 0\)</span> a s tímto novým intervalem pak pokračujeme znovu.</p>
<p>Tento postup následně opakujeme, dokud nedosáhneme požadované přesnosti. Kořenem dané rovnice je střed intervalu a požadovanou přesností je polovina momentálního intervalu <span class="math inline">\(\langle a, b \rangle\)</span>.</p>
<div class="columns">
<div class="column" style="width:45%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="bisection1.jpg" class="img-fluid figure-img"></p>
<figcaption>Původní interval <span class="math inline">\(\langle a,b \rangle\)</span></figcaption>
</figure>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="bisection2.jpg" class="img-fluid figure-img"></p>
<figcaption>Vytvoření nového intervalu <span class="math inline">\(\langle a,c \rangle\)</span></figcaption>
</figure>
</div>
</div>
</div>
<section id="metoda-půlení-intervalu-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="metoda-půlení-intervalu-v-jazyce-r">Metoda půlení intervalu v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkce: bisection(f, a, b, tol, maxIter)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   - f:        spojitá funkce jedné proměnné (function(x) ...)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   - a, b:     krajní body intervalu, kde f(a) * f(b) &lt; 0</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   - tol:      tolerance chyby (např. 1e-6)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - maxIter:  maximální počet iterací</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>bisection <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">maxIter =</span> <span class="dv">100</span>) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Výpočet hodnot na krajích intervalu</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  fa <span class="ot">&lt;-</span> <span class="fu">f</span>(a)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  fb <span class="ot">&lt;-</span> <span class="fu">f</span>(b)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Podmínka nutná pro zaručení kořene (f(a)*f(b) &lt; 0)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (fa <span class="sc">*</span> fb <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Chyba: Na intervalu není změna znaménka — nelze zaručit kořen.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Proměnná pro střed intervalu</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterační smyčka</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxIter) {</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> (a <span class="sc">+</span> b) <span class="sc">/</span> <span class="dv">2</span>          <span class="co"># střed intervalu</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    fc <span class="ot">&lt;-</span> <span class="fu">f</span>(c)                <span class="co"># hodnota funkce ve středu</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kontrola přesnosti — splněno?</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(fc) <span class="sc">&lt;</span> tol <span class="sc">||</span> (b <span class="sc">-</span> a) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">&lt;</span> tol) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Konvergence dosažena po %d iteracích.</span><span class="sc">\n</span><span class="st">"</span>, i))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(c)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Výběr nového intervalu podle znaménka</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fa <span class="sc">*</span> fc <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      b <span class="ot">&lt;-</span> c</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>      fb <span class="ot">&lt;-</span> fc</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>      a <span class="ot">&lt;-</span> c</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>      fa <span class="ot">&lt;-</span> fc</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pokud metoda neskonverguje do maxIter</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Varování: Metoda nedosáhla požadované přesnosti.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># PŘÍKLAD POUŽITÍ</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Definice testovací funkce</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x <span class="sc">-</span> <span class="dv">2</span>   <span class="co"># známe kořen ≈ 1.52138</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Spuštění bisekce</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="fu">bisection</span>(f, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">tol =</span> <span class="fl">1e-8</span>, <span class="at">maxIter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Konvergence dosažena po 27 iteracích.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(root)) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Nalezený kořen: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, root))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kontrola: f(x) = %.3e</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">f</span>(root)))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nalezený kořen: x = 1.521379701793
Kontrola: f(x) = -2.979e-08</code></pre>
</div>
</div>
</section>
</section>
<section id="metoda-regula-falsi" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="metoda-regula-falsi"><span class="header-section-number">2.3</span> Metoda regula falsi</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace včetně příkladů naleznete v učebnicích:</p>
<ul>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/Numerika.pdf">Numerika</a> na stranách 39-40,</li>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/FINALNI_VERZE_CD.pdf">Numerické metody</a> na stranách 26-28.</li>
</ul>
<p>Interaktivní vizualizace metody (na vámi zadaném příkladu):</p>
<ul>
<li><a href="https://www.geogebra.org/m/eesrxayk">Regula Falsi</a></li>
</ul>
</div>
</div>
</div>
<p>Princip metody regula falsi se do značné míry podobá bisekci. Stále předpokládám spojitou funkci <span class="math inline">\(f\)</span> a interval <span class="math inline">\(\langle a, b \rangle\)</span>, pro nějž platí <span class="math inline">\(f(a) \cdot f(b) &lt; 0\)</span>.</p>
<p>Rozdělení intervalu nyní nespočívá v půlení intervalu, nýbrž ve spojení funkčních hodnot <span class="math inline">\(f(a)\)</span> a <span class="math inline">\(f(b)\)</span>. Nový bod, který rozdělí interval, vznikne jako průsečík těchto bodů a osy <span class="math inline">\(x\)</span>.</p>
<div class="columns">
<div class="column" style="width:45%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="regula_falsi1.jpg" class="img-fluid figure-img"></p>
<figcaption>Původní interval <span class="math inline">\(\langle a,b \rangle\)</span></figcaption>
</figure>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="regula_falsi2.jpg" class="img-fluid figure-img"></p>
<figcaption>Vytvoření nového intervalu <span class="math inline">\(\langle c,b \rangle\)</span></figcaption>
</figure>
</div>
</div>
</div>
<section id="metoda-regula-falsi-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="metoda-regula-falsi-v-jazyce-r">Metoda regula falsi v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vstupy:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   f         ... funkce jedné proměnné (function(x) ...)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   a         ... levý kraj intervalu</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   b         ... pravý kraj intervalu</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   tol       ... tolerance přesnosti (kdy končí výpočet)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   max_iter  ... maximální počet iterací</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>regula_falsi <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">100</span>) {</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  fa <span class="ot">&lt;-</span> <span class="fu">f</span>(a)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  fb <span class="ot">&lt;-</span> <span class="fu">f</span>(b)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Výpočet průsečíku sekanty s osou x</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> (a <span class="sc">*</span> fb <span class="sc">-</span> b <span class="sc">*</span> fa) <span class="sc">/</span> (fb <span class="sc">-</span> fa)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    fc <span class="ot">&lt;-</span> <span class="fu">f</span>(c)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Iterace %02d: a = %.6f, b = %.6f, c = %.12f, f(c) = %.6e</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                i, a, b, c, fc))</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Zastavení: pokud f(c) je dostatečně blízko nule</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(fc) <span class="sc">&lt;</span> tol) {</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Kořen nalezen po %d iteracích: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, i, c))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kontrola: f(x) = %.3e</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">f</span>(c)))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(c)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Posun intervalu — vybíráme tu polovinu, kde je změna znaménka</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fa <span class="sc">*</span> fc <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>      b  <span class="ot">&lt;-</span> c</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      fb <span class="ot">&lt;-</span> fc</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>      a  <span class="ot">&lt;-</span> c</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>      fa <span class="ot">&lt;-</span> fc</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pokud metoda nekonverguje</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Nedosaženo tolerance po %d iteracích. Poslední aproximace: %.12f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>              max_iter, c))</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(c)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="co"># PŘÍKLAD POUŽITÍ</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x <span class="sc">-</span> <span class="dv">2</span>  <span class="co"># známý testovací příklad (kořen ~1.521)</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="fu">regula_falsi</span>(f, <span class="dv">1</span>, <span class="dv">2</span>, <span class="at">tol =</span> <span class="fl">1e-8</span>, <span class="at">max_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iterace 01: a = 1.000000, b = 2.000000, c = 1.333333333333, f(c) = -9.629630e-01
Iterace 02: a = 1.333333, b = 2.000000, c = 1.462686567164, f(c) = -3.333389e-01
Iterace 03: a = 1.462687, b = 2.000000, c = 1.504019003950, f(c) = -1.018180e-01
Iterace 04: a = 1.504019, b = 2.000000, c = 1.516330564760, f(c) = -2.989480e-02
Iterace 05: a = 1.516331, b = 2.000000, c = 1.519918550023, f(c) = -8.675066e-03
Iterace 06: a = 1.519919, b = 2.000000, c = 1.520957481372, f(c) = -2.508805e-03
Iterace 07: a = 1.520957, b = 2.000000, c = 1.521257749126, f(c) = -7.248228e-04
Iterace 08: a = 1.521258, b = 2.000000, c = 1.521344484232, f(c) = -2.093499e-04
Iterace 09: a = 1.521344, b = 2.000000, c = 1.521369534538, f(c) = -6.046133e-05
Iterace 10: a = 1.521370, b = 2.000000, c = 1.521376769087, f(c) = -1.746113e-05
Iterace 11: a = 1.521377, b = 2.000000, c = 1.521378858404, f(c) = -5.042711e-06
Iterace 12: a = 1.521379, b = 2.000000, c = 1.521379461790, f(c) = -1.456314e-06
Iterace 13: a = 1.521379, b = 2.000000, c = 1.521379636045, f(c) = -4.205770e-07
Iterace 14: a = 1.521380, b = 2.000000, c = 1.521379686370, f(c) = -1.214608e-07
Iterace 15: a = 1.521380, b = 2.000000, c = 1.521379700903, f(c) = -3.507733e-08
Iterace 16: a = 1.521380, b = 2.000000, c = 1.521379705100, f(c) = -1.013017e-08
Iterace 17: a = 1.521380, b = 2.000000, c = 1.521379706312, f(c) = -2.925550e-09

Kořen nalezen po 17 iteracích: x = 1.521379706312
Kontrola: f(x) = -2.926e-09</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.52138</code></pre>
</div>
</div>
</section>
</section>
<section id="newtonova-metoda-tečen" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="newtonova-metoda-tečen"><span class="header-section-number">2.4</span> Newtonova metoda tečen</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace včetně příkladů naleznete v učebnicích:</p>
<ul>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/Numerika.pdf">Numerika</a> na stranách 41-44,</li>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/FINALNI_VERZE_CD.pdf">Numerické metody</a> na stranách 29-33.</li>
</ul>
<p>Interaktivní vizualizace metody:</p>
<ul>
<li><a href="https://www.geogebra.org/m/zn7sj2yd">Metoda tečen (Newtonova metoda)</a></li>
</ul>
</div>
</div>
</div>
<p>Metoda tečen je metodou velice účinnou, nicméně ne vždy konverguje.</p>
<p>Tato metoda je dokonce i snadno odvoditelná z následujícího obrázku (pochopitelně za předpokladu, že bude konvergovat).</p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="newton.jpg" class="img-fluid figure-img"></p>
<figcaption>Ilustrace Newtonovy metody</figcaption>
</figure>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="newton_triangle.jpg" class="img-fluid figure-img"></p>
<figcaption>Trojúhelník k odvození</figcaption>
</figure>
</div>
</div>
</div>
<p>Z grafu funkce s tečnou můžeme převzít trojúhelník napravo a z něho následně takto odvodit metodu tečen: <span class="math display">\[tg \; \alpha = \frac{y_0}{x_0-x_1} = \frac{f(x_0)}{x_0-x_1}\]</span> Zdánlivým problémem je, že neznáme hodnotu <span class="math inline">\(tg \; \alpha\)</span>, vzpomeneme-li však na základy diferenciálního počtu, dojdeme k rovnosti <span class="math inline">\(tg \; \alpha = f'(x)\)</span>. To můžeme dosadit zpět do naší rovnice a obdržíme následující rovnost: <span class="math display">\[f'(x_0) = \frac{f(x_0)}{x_0-x_1}\]</span> Toto můžeme několika jednoduchými úpravami dostat do tvaru, kde bude vyjádřeno <span class="math inline">\(x_1\)</span>. <span class="math display">\[x_0-x_1 = \frac{f(x_0)}{f'(x_0)}\]</span> <span class="math display">\[x_1 = x_0 -\frac{f(x_0)}{f'(x_0)}\]</span></p>
<p>Druhou variantou je odvození tohoto vzorce z Taylorova polynomu. Mějme tedy toto vyjádření funkce pomocí Taylorova polynomu <span class="math display">\[f(x) = f(x_0) + f'(x_0)(x-x_0)\]</span> Nyní je potřeba dosadit takto <span class="math inline">\(x \coloneqq x_1\)</span>, čímž dostaneme tvar <span class="math display">\[f(x_1) = f(x_0) + f'(x_0)(x_1-x_0)\]</span> A protože se bod v <span class="math inline">\(x_1\)</span> nachází na ose <span class="math inline">\(x\)</span>, pak musí platit <span class="math inline">\(f(x_1) = 0\)</span>, tím dostaneme rovnost, z níž vyjádříme <span class="math inline">\(x_1\)</span>. <span class="math display">\[0 = f(x_0) + f'(x_0)(x_1-x_0)\]</span> <span class="math display">\[-\frac{f(x_0)}{f'(x_0)} = x_1-x_0\]</span> <span class="math display">\[x_1 = x_0 + \frac{f(x_0)}{f'(x_0)}\]</span></p>
<section id="newtonova-metoda-tečen-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="newtonova-metoda-tečen-v-jazyce-r">Newtonova metoda tečen v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vstupy:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   f   ... funkce, jejíž kořen hledáme</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   fd  ... derivace funkce f</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   x0  ... počáteční odhad (bod, kde "začneme" tečnu)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   tol ... tolerance přesnosti (typicky 1e-8)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   max_iter ... maximální počet iterací</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>newton_tecen <span class="ot">&lt;-</span> <span class="cf">function</span>(f, fd, x0, <span class="at">tol =</span> <span class="fl">1e-8</span>, <span class="at">max_iter =</span> <span class="dv">100</span>) {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Iterace |        x        |       f(x)       </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"---------------------------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    fx  <span class="ot">&lt;-</span> <span class="fu">f</span>(x0)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    fdx <span class="ot">&lt;-</span> <span class="fu">fd</span>(x0)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Newtonův krok — průsečík tečny s osou x</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x0 <span class="sc">-</span> fx <span class="sc">/</span> fdx</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%5d   | %14.10f | %14.6e</span><span class="sc">\n</span><span class="st">"</span>, i, x1, fx))</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># kontrola přesnosti</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(x1 <span class="sc">-</span> x0) <span class="sc">&lt;</span> tol) {</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Konvergence dosažena po"</span>, i, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kořen: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, x1))</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kontrola: f(x) = %.3e</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">f</span>(x1)))</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x1)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># posun na další iteraci</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> x1</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Nedosaženo tolerance po"</span>, max_iter, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Poslední aproximace: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, x1))</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x1)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co"># PŘÍKLAD POUŽITÍ</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Rovnice: x^3 - x - 2 = 0</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Derivace: 3x^2 - 1</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Skutečný kořen ≈ 1.52138</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>f  <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">3</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Spustíme metodu s počátečním odhadem x0 = 2</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="fu">newton_tecen</span>(f, fd, <span class="at">x0 =</span> <span class="dv">2</span>, <span class="at">tol =</span> <span class="fl">1e-8</span>, <span class="at">max_iter =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iterace |        x        |       f(x)       
---------------------------------------------
    1   |   1.6363636364 |   4.000000e+00
    2   |   1.5303920521 |   7.453043e-01
    3   |   1.5214414651 |   5.393892e-02
    4   |   1.5213797097 |   3.670959e-04
    5   |   1.5213797068 |   1.740686e-08

 Konvergence dosažena po 5 iteracích.
Kořen: x = 1.521379706805
Kontrola: f(x) = 0.000e+00</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.52138</code></pre>
</div>
</div>
</section>
</section>
<section id="steffensenova-metoda" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="steffensenova-metoda"><span class="header-section-number">2.5</span> Steffensenova metoda</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další vysvětlení naleznete v učebnici:</p>
<ul>
<li><a href="https://math.fme.vutbr.cz/download.aspx?id_file=246843468">Numerické metody</a> na stranách 85-86.</li>
</ul>
</div>
</div>
</div>
<p>Steffensenova metoda je iterativní metodou hledání kořene. Je v podstatě úpravou předchozí Newtonovy metody tečen, respektive úpravou jeho předpisu. <span class="math display">\[x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}\]</span> Tato metoda však odstraňuje derivaci ve jmenovateli a nahrazuje ji funkcí <span class="math inline">\(g\)</span>, která je v podstatě předpisem derivace, ovšem bez limitní úvahy. <span class="math display">\[x_{n+1} = x_n - \frac{f(x_n)}{g(x_n)}\]</span> <span class="math display">\[g(x) = \frac{f(x+h)-f(x)}{h}\]</span> Uvažujeme tak, že pro toto vyjádření platí, že v určitém bodě bude přibližně rovno derivaci funkce <span class="math inline">\(f\)</span>. <span class="math display">\[f'(x_k) \approx g(x_k) = d_k = \frac{f(x_k+h_k)-f(x_k)}{h_k}\]</span> Jako hodnotu <span class="math inline">\(h_k\)</span> používáme odhad derivace tak, že <span class="math inline">\(h_k = f(x_k)\)</span>.</p>
<section id="steffensenova-metoda-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="steffensenova-metoda-v-jazyce-r">Steffensenova metoda v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vstupy:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   f         ... funkce jedné proměnné (function(x) ...)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   x0        ... počáteční odhad kořene</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   tol       ... tolerance přesnosti v x (|x_{n+1} - x_n|)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   max_iter  ... maximální počet iterací</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>steffensen <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x0, <span class="at">tol =</span> <span class="fl">1e-8</span>, <span class="at">max_iter =</span> <span class="dv">100</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) {</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Iterace |        x        |        f(x)       </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"------------------------------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    fx <span class="ot">&lt;-</span> <span class="fu">f</span>(x0)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    h  <span class="ot">&lt;-</span> fx                           <span class="co"># odhad kroku (h = f(x))</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    gx <span class="ot">&lt;-</span> (<span class="fu">f</span>(x0 <span class="sc">+</span> h) <span class="sc">-</span> fx) <span class="sc">/</span> h         <span class="co"># g(x) ≈ kvaziderivace</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x0 <span class="sc">-</span> fx <span class="sc">/</span> gx                 <span class="co"># Steffensenův krok</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verbose) {</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%5d   | %14.10f | %14.6e</span><span class="sc">\n</span><span class="st">"</span>, i, x1, fx))</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kritérium zastavení: změna v x je menší než tolerance</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(x1 <span class="sc">-</span> x0) <span class="sc">&lt;</span> tol) {</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (verbose) {</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Konvergence dosažena po"</span>, i, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kořen: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, x1))</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kontrola: f(x) = %.3e</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">f</span>(x1)))</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x1)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> x1</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) {</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">  Nedosaženo tolerance po"</span>, max_iter, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Poslední aproximace: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, x1))</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x1)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="co"># PŘÍKLADY POUŽITÍ</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Příklad : Polynom x^3 - x - 2 = 0 -------------------</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Kořen by měl být přibližně 1.52138</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Příklad 1: x^3 - x - 2 ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Příklad 1: x^3 - x - 2 ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">steffensen</span>(f1, <span class="at">x0 =</span> <span class="dv">2</span>, <span class="at">tol =</span> <span class="fl">1e-10</span>, <span class="at">max_iter =</span> <span class="dv">50</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iterace |        x        |        f(x)       
------------------------------------------------
    1   |   1.9215686275 |   4.000000e+00
    2   |   1.8390171380 |   3.173681e+00
    3   |   1.7538351821 |   2.380509e+00
    4   |   1.6699194054 |   1.640853e+00
    5   |   1.5956281040 |   9.868693e-01
    6   |   1.5442710432 |   4.668874e-01
    7   |   1.5239532939 |   1.384649e-01
    8   |   1.5214146889 |   1.532710e-02
    9   |   1.5213797133 |   2.079320e-04
   10   |   1.5213797068 |   3.877858e-08
   11   |   1.5213797068 |   1.332268e-15

 Konvergence dosažena po 11 iteracích.
Kořen: x = 1.521379706805
Kontrola: f(x) = 0.000e+00</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.52138</code></pre>
</div>
</div>
</section>
</section>
<section id="halleyova-metoda" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="halleyova-metoda"><span class="header-section-number">2.6</span> Halleyova metoda</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace včetně důkazu této metody naleznete na webu:</p>
<ul>
<li><a href="https://proofwiki.org/wiki/Halley%27s_Method">Halley’s method</a>.</li>
</ul>
</div>
</div>
</div>
<p>Na rozdíl od Steffensenovy metody, která derivace eliminovala, počítá Halleyova metoda i s druhou derivací. Vychází ze vzorce <span class="math display">\[x_{n+1} = x_n - \frac{f(x_n)f'(x_n)}{|f'(x_n)|^2-\frac{1}{2}f(x_n)f''(x_n)}\]</span></p>
<section id="halleyova-metoda-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="halleyova-metoda-v-jazyce-r">Halleyova metoda v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vstupy:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   f        ... funkce f(x)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   fd       ... první derivace f'(x)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   fdd      ... druhá derivace f''(x)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   x0       ... počáteční odhad</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   tol      ... tolerance pro |x_{n+1} - x_n|</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   max_iter ... maximální počet iterací</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   verbose  ... TRUE = tisk průběhu, FALSE = ticho</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>halley <span class="ot">&lt;-</span> <span class="cf">function</span>(f, fd, fdd, x0, <span class="at">tol =</span> <span class="fl">1e-8</span>, <span class="at">max_iter =</span> <span class="dv">100</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) {</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Iterace |        x        |        f(x)       </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"------------------------------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    y   <span class="ot">&lt;-</span> <span class="fu">f</span>(x0)          <span class="co"># f(x_n)</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    yd  <span class="ot">&lt;-</span> <span class="fu">fd</span>(x0)         <span class="co"># f'(x_n)</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    ydd <span class="ot">&lt;-</span> <span class="fu">fdd</span>(x0)        <span class="co"># f''(x_n)</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    denom <span class="ot">&lt;-</span> (yd <span class="sc">*</span> yd) <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> y <span class="sc">*</span> ydd</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x0 <span class="sc">-</span> (y <span class="sc">*</span> yd) <span class="sc">/</span> denom</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%5d   | %14.10f | %14.6e</span><span class="sc">\n</span><span class="st">"</span>, i, x1, y))</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kritérium zastavení: dostatečná přesnost v x</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(x1 <span class="sc">-</span> x0) <span class="sc">&lt;</span> tol) {</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (verbose) {</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Konvergence dosažena po"</span>, i, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kořen: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, x1))</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kontrola: f(x) = %.3e</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">f</span>(x1)))</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x1)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> x1</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) {</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">  Nedosaženo tolerance po"</span>, max_iter, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Poslední aproximace: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, x1))</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x1)</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="co"># PŘÍKLADY POUŽITÍ</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co"># === PŘÍKLAD 1: x^3 - x - 2 = 0 ==========================</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Kořen ≈ 1.521379707</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>f   <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>fd  <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">3</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>fdd <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">6</span><span class="sc">*</span>x</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Příklad 1: x^3 - x - 2 ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Příklad 1: x^3 - x - 2 ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">halley</span>(f, fd, fdd, <span class="at">x0 =</span> <span class="dv">2</span>, <span class="at">tol =</span> <span class="fl">1e-12</span>, <span class="at">max_iter =</span> <span class="dv">20</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iterace |        x        |        f(x)       
------------------------------------------------
    1   |   1.5463917526 |   4.000000e+00
    2   |   1.5213860771 |   1.515373e-01
    3   |   1.5213797068 |   3.786358e-05
    4   |   1.5213797068 |   0.000000e+00

 Konvergence dosažena po 4 iteracích.
Kořen: x = 1.521379706805
Kontrola: f(x) = 0.000e+00</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.52138</code></pre>
</div>
</div>
</section>
</section>
<section id="fixed-point-iteration" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="fixed-point-iteration"><span class="header-section-number">2.7</span> Fixed-point iteration</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>Další informace můžete najít v učebnicích:</p>
<ul>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/Numerika.pdf">Numerika</a> na straně 44, 45,</li>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/FINALNI_VERZE_CD.pdf">Numerické metody</a> na stranách 34-39.</li>
</ul>
<p>Interaktivní vizualizace metody:</p>
<ul>
<li><a href="https://www.geogebra.org/m/qUbg7Z6W">Fixed point iteration</a></li>
</ul>
</div>
</div>
</div>
<p>Fixed-point iteration (nebo také metoda prosté iterace) vychází z jednoduché myšlenky. Obecnou rovnici, kterou řešíme, tedy <span class="math display">\[f(x) = 0,\]</span> upravíme do tvaru <span class="math display">\[x = g(x).\]</span> Funkci <span class="math inline">\(g\)</span> tu nazýváme iterační funkcí. Nyní nebudeme hledat kořen rovnice, nýbrž pevný bod funkce <span class="math inline">\(g.\)</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definice pevného bodu
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mějme množinu <span class="math inline">\(X.\)</span> Prvek <span class="math inline">\(x \in X\)</span> se nazývá pevný bod zobrazení <span class="math inline">\(F: X \to X\)</span>, jestliže platí <span class="math inline">\(F(x) = x.\)</span></p>
</div>
</div>
<p>Zvolíme počáteční aproximaci <span class="math inline">\(x_0\)</span> a další aproximace pevného bodu bude <span class="math display">\[x_{k+1} = g(x_k).\]</span></p>
<p>Ve výše uvedeném zdroji naleznete i podmínku konvergence této metody.</p>
<p>Naší rovnici <span class="math display">\[0 = f(x) = x^3 - x - 2\]</span> si v tuto chvíli musíme upravit do tvaru, který popíše iterační funkci. <span class="math display">\[
x^3 - x- 2=0 \implies x= \sqrt[3]{x+2}
\]</span> V tuto chvíli je naší iterační funkcí <span class="math display">\[g(x) = \sqrt[3]{x+2}.\]</span></p>
<section id="fixed-point-iteration-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="fixed-point-iteration-v-jazyce-r">Fixed-point iteration v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed point iteration</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Vstupy:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   f        ... funkce pro iteraci </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   x0       ... počáteční odhad</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   max_iter ... maximální počet iterací</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   eps      ... tolerance přesnosti</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   verbose  ... TRUE = tisk průběhu, FALSE = ticho</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>FixedPointIteration <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x0, <span class="at">max_iter =</span> <span class="dv">1000</span>, <span class="at">eps =</span> <span class="fl">1e-8</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) {</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Iterace |        x        |        f(x)       </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"------------------------------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">f</span>(x0)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verbose)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%5d   | %14.10f | %14.6e</span><span class="sc">\n</span><span class="st">"</span>, i, x, <span class="fu">f</span>(x0)))</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pokud je změna menší než tolerance → konvergence</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(x <span class="sc">-</span> x0) <span class="sc">&lt;</span> eps) {</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (verbose) {</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Konvergence dosažena po"</span>, i, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Pevný bod: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, x))</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Kontrola: f(x) = %.12f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">f</span>(x)))</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">iter =</span> i))</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> x</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) {</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">  Nedosaženo tolerance po"</span>, max_iter, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Poslední aproximace: x = %.12f</span><span class="sc">\n</span><span class="st">"</span>, x))</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">iter =</span> max_iter))</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Příklad:</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="co"># f(x) = x^3 - x - 2</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Přepis do tvaru pevného bodu: x = (x + 2)^(1/3)</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">+</span> <span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Příklad 2: f(x) = x^3 - x - 2 ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Příklad 2: f(x) = x^3 - x - 2 ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FixedPointIteration</span>(f2, <span class="at">x0 =</span> <span class="fl">1.5</span>, <span class="at">eps =</span> <span class="fl">1e-12</span>, <span class="at">max_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iterace |        x        |        f(x)       
------------------------------------------------
    1   |   1.5182944859 |   1.518294e+00
    2   |   1.5209352632 |   1.520935e+00
    3   |   1.5213156982 |   1.521316e+00
    4   |   1.5213704886 |   1.521370e+00
    5   |   1.5213783793 |   1.521378e+00
    6   |   1.5213795156 |   1.521380e+00
    7   |   1.5213796793 |   1.521380e+00
    8   |   1.5213797028 |   1.521380e+00
    9   |   1.5213797062 |   1.521380e+00
   10   |   1.5213797067 |   1.521380e+00
   11   |   1.5213797068 |   1.521380e+00
   12   |   1.5213797068 |   1.521380e+00
   13   |   1.5213797068 |   1.521380e+00
   14   |   1.5213797068 |   1.521380e+00

 Konvergence dosažena po 14 iteracích.
Pevný bod: x = 1.521379706805
Kontrola: f(x) = 1.521379706805</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] 1.52138

$iter
[1] 14</code></pre>
</div>
</div>
</section>
</section>
<section id="newtonova-hornerova-metoda" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="newtonova-hornerova-metoda"><span class="header-section-number">2.8</span> Newtonova-Hornerova metoda</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujícím materiálu naleznete další podrobnosti o této metodě:</p>
<ul>
<li><a href="https://physics.ujep.cz/~jskvor/NME/Okruhy/NewtonHorner.pdf">Hornerovo schéma a jeho aplikace v Newtonově metodě</a> (včetně odvození).</li>
</ul>
</div>
</div>
</div>
<p>K aplikování Newtonovy-Hornerovy metody je nutné znát princip Hornerova schématu. To se týká polynomu a dává nám o něm zajímavé informace.</p>
<section id="hornerovo-schéma" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="hornerovo-schéma">Hornerovo schéma</h3>
<p>Mějme polynom <span class="math display">\[p(x) = a_0 + a_1x + a_2x^2 + \ldots + a_nx^n,\]</span> kde <span class="math inline">\(a_0, a_1, \ldots\)</span> jsou koeficienty. Celá myšlenka souvisí s možným vyjádřením polynomu ve tvaru <span class="math display">\[p(x) = a_0 + x(a_1 + x(a_2 + x(a_3 + \ldots+x(a_{n-1}+a_nx)\ldots)))\]</span></p>
<p>Ukažme si Hornerovo schéma na polynomu <span class="math inline">\(p(x) = 11x^3-4x^2+3x + 2\)</span> v bodě 3. Do vrchní části tabulky si zapíšeme koeficienty v sestupném pořadí mocnin <span class="math inline">\(x\)</span>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>11</th>
<th>-4</th>
<th>3</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td></td>
<td>33</td>
<td>87</td>
<td>270</td>
</tr>
<tr class="even">
<td></td>
<td>11</td>
<td>29</td>
<td>90</td>
<td>272</td>
</tr>
</tbody>
</table>
<p>Na tomto příkladu je vidět, že čísla v prvním a druhém řádku ve stejném sloupci se sčítají, zatímco, abychom dostali hodnotu ve druhém řádku, musíme vynásobit hodnotu z předchozího sloupce a následujícího řádku hledaným bodem, v našem případem číslem 3.</p>
<p>Číslo v posledním sloupci a řádku, v našem případě 272, je hodnota polynomu v bodě, tedy <span class="math inline">\(p(3) = 272.\)</span> Čísla na třetím řádku jsou zároveň koeficienty výsledného polynomu po dělení původního polynomu polynomem tvaru <span class="math inline">\(x-k\)</span>, kde <span class="math inline">\(k\)</span> je vybraný bod. Zde by to bylo tedy <span class="math display">\[(11x^3-4x^2+3x + 2):(x-3)=11x^2+29x+90 + \frac{272}{x-3}\]</span></p>
<p>Tabulku lze rozšířit a zjišťovat z ní další informace.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>11</th>
<th>-4</th>
<th>3</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td></td>
<td>33</td>
<td>87</td>
<td>270</td>
</tr>
<tr class="even">
<td></td>
<td>11</td>
<td>29</td>
<td>90</td>
<td>272</td>
</tr>
<tr class="odd">
<td>3</td>
<td></td>
<td>33</td>
<td>186</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>11</td>
<td>62</td>
<td>276</td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td></td>
<td>33</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>11</td>
<td>95</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>11</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Čísla na vedlejší diagonále jsou potom hodnoty jednotlivých derivací, a to následovně: <span class="math display">\[p(3) = 272\]</span> <span class="math display">\[p'(3) = 276\]</span> <span class="math display">\[\frac{1}{2}p''(3) = 95\]</span> <span class="math display">\[\frac{1}{6}p'''(3) = 11\]</span></p>
<p>Obecně by tedy šlo zapsat, že na diagonále leží postupně hodnoty derivací ve tvaru <span class="math inline">\(\frac{1}{k!}p^{(k)}(x)\)</span>, kde <span class="math inline">\(k\)</span> je stupeň derivace příslušného polynomu.</p>
</section>
<section id="newtonova-hornerova-metoda-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="newtonova-hornerova-metoda-v-jazyce-r">Newtonova-Hornerova metoda v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vstupy:</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Koeficienty polynomu od konstantního členu po nejvyšší mocninu:</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   Např. x^2 - 2  →  a = c(-2, 0, 1)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   Např. x^3 - x - 2 → a = c(-2, -1, 0, 1)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   Např. x^3 - 6x^2 + 11x - 6 → a = c(-6, 11, -6, 1)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># a &lt;- c(-2, 0, 1)        koeficienty (polynom x^2 - 2)</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># x0 &lt;- 2                 počáteční odhad kořene</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># tol &lt;- 1e-7             tolerance konvergence (přesnost)</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># max_iter &lt;- 1000        maximální počet iterací</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNKCE HORNER</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(a, x){</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a ... numeric vektor koeficientů (a0, a1, ..., a_{n-1})</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x ... bod, ve kterém vyhodnocujeme</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Výstup: c(y, yd), kde y = f(x), yd = f'(x)</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> a[n]           <span class="co"># začínáme od nejvyššího členu</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    yd <span class="ot">&lt;-</span> y</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">2</span>){</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        y  <span class="ot">&lt;-</span> y<span class="sc">*</span>x <span class="sc">+</span> a[i]   <span class="co"># klasický Horner pro f(x)</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        yd <span class="ot">&lt;-</span> yd<span class="sc">*</span>x <span class="sc">+</span> y     <span class="co"># Horner pro f'(x)</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y<span class="sc">*</span>x <span class="sc">+</span> a[<span class="dv">1</span>]</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(y, yd))</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(y, <span class="dv">0</span>))     <span class="co"># pokud je polynom konstantní</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNKCE NEWTON–HORNER</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>NewtonHorner <span class="ot">&lt;-</span> <span class="cf">function</span>(a, x0, <span class="at">tol =</span> <span class="fl">1e-7</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>){</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a   ... koeficienty polynomu</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x0  ... počáteční odhad</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tol ... tolerance pro konvergenci</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># max_iter ... maximální počet iterací</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x0</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter){</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">Horner</span>(a, x)       <span class="co"># res[1]=f(x), res[2]=f'(x)</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>    dx  <span class="ot">&lt;-</span> res[<span class="dv">1</span>] <span class="sc">/</span> res[<span class="dv">2</span>]    <span class="co"># Newtonův krok</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(dx) <span class="sc">&lt;</span> tol){</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Konvergence dosažena po"</span>, i, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x)</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">-</span> dx</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Varování: nedošlo ke konvergenci po"</span>, max_iter, <span class="st">"iteracích.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="co"># TESTY</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== TEST 2: f(x) = x^3 - x - 2 ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== TEST 2: f(x) = x^3 - x - 2 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># x^3 - x - 2</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>root2 <span class="ot">&lt;-</span> <span class="fu">NewtonHorner</span>(a2, <span class="at">x0 =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Konvergence dosažena po 6 iteracích.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odhadnutý kořen ≈"</span>, root2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)   <span class="co"># očekáváme cca 1.521</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odhadnutý kořen ≈ 1.52138 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="řešení-soustav-lineárních-rovnic" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Řešení soustav lineárních rovnic</h1>
<p>Soustavu lineárních rovnic můžeme zapisovat dvěma způsoby. Tím prvním je klasický zápis soustavy pomocí výčtu jednotlivých rovnic, a to takto <span class="math display">\[
\begin{array}{c}
a_{11}x_1 + a_{12}x_2 + \dots + a_{1n}x_n &amp; = &amp; b_1 \\
a_{21}x_1 + a_{22}x_2 + \dots + a_{2n}x_n &amp; = &amp; b_2 \\
\vdots &amp; &amp; \vdots \\
a_{n1}x_1 + a_{n2}x_2 + \dots + a_{nn}x_n &amp; = &amp; b_n.
\end{array}
\]</span> Pochopitelně u uvedeného příkladu by za účelem obecnosti měl být rozdílný rozměr, např. <span class="math inline">\(m\)</span> řádků a <span class="math inline">\(n\)</span> sloupců. My však budeme numericky řešit soustavu lineárních rovnic o <span class="math inline">\(n\)</span> rovnicích a <span class="math inline">\(n\)</span> neznámých. Druhým způsobem je poté forma maticového zápisu soustavy lineárních rovnic <span class="math display">\[
A\vec{x} = \vec{b},
\]</span> kde <span class="math inline">\(A\)</span> je matice soustavy, <span class="math inline">\(\vec{x}\)</span> je vektor neznámých a <span class="math inline">\(\vec{b}\)</span> je vektorem pravých stran. Výše zmíněná shoda obou rozměrů se tu projeví tak, že bude matice <span class="math inline">\(A\)</span> maticí čtvercovou. Pro další práci s touto formou zápisu soustavy rovnic je vhodné připomenout i pojem rozšířená matice soustavy, značme ji <span class="math inline">\(A^*\)</span>. <span class="math display">\[
A^* =
\begin{pmatrix}
\begin{array}{cccc|c}
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} &amp; b_1 \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} &amp;b_2 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots \\
a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} &amp;b_n
\end{array}
\end{pmatrix}
\]</span> Z následující věty plyne fakt, že pokud známe matici soustavu a rozšířenou matici soustavy, řešení bude mít právě tehdy, když mají obě matice stejnou hodnost, tj. stejný počet lineárně nezávislých řádků.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Frobeniova věta
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nechť <span class="math inline">\(A \in T^{m,n}\)</span> a <span class="math inline">\(\vec{b} \in T^m\)</span>. Potom pro soustavu lineárních rovnic <span class="math inline">\(A \cdot \vec{x} = \vec{b}\)</span> platí, že soustava má řešení právě tehdy když <span class="math inline">\(h(A) = h(A^*)\)</span>.</p>
</div>
</div>
<p>Pokud se hodnosti liší, pak soustava nemá řešení. Ovšem pokud platí, že <span class="math inline">\(h(A) = h(A^*)\)</span>, mohou nastat dvě situace:</p>
<ol type="1">
<li><p><span class="math inline">\(h(A) = n\)</span>, pak má soustava právě jedno řešení</p></li>
<li><p><span class="math inline">\(h(A) &lt; n\)</span>, pak má soustava nekonečně mnoho řešení.</p></li>
</ol>
<p>Důvodem, proč nemůže nastat situace <span class="math inline">\(h(A) &gt; n\)</span>, je počet řádků matice <span class="math inline">\(A\)</span>, a to je <span class="math inline">\(n\)</span>.</p>
<p>Nyní si musíme připomenout ekvivaletní úpravy matice:</p>
<ol type="1">
<li><p>záměna dvou řádků</p></li>
<li><p>vynásobení řádku nenulovým číslem</p></li>
<li><p>připočtení jednoho řádku k jinému</p></li>
</ol>
<section id="volba-vhodné-soustavy-k-řešení" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="volba-vhodné-soustavy-k-řešení"><span class="header-section-number">3.1</span> Volba vhodné soustavy k řešení</h2>
<p>Zvolme si soustavu lineárních rovnic, na níž budeme představovat jednotlivé metody jejího řešení. A zvolme ji následovně</p>
<p><span class="math display">\[
\begin{aligned}
10x_1 - 2x_2 + 3x_3 - x_4 + 2x_5 &amp;= 27 \\
-3x_1 + 9x_2 + x_3 + 7x_4 - 2x_5 &amp;= -61.5 \\
2x_1 - x_2 - 7x_3 + 3x_4 + 8x_5 &amp;= -21.25 \\
x_1 + 7x_2 - 5x_3 + 10x_4 + x_5 &amp;= -41.1 \\
-2x_1 + 3x_2 + 8x_3 - 4x_4 + 15x_5 &amp;= 100.2
\end{aligned}
\]</span></p>
</section>
<section id="gaussova-eliminační-metoda" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="gaussova-eliminační-metoda"><span class="header-section-number">3.2</span> Gaussova eliminační metoda</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujícím materiálu naleznete vysvětlení metody prezentované na příkladu:</p>
<ul>
<li><a href="https://frodo.fp.tul.cz/~cvrcek/mv2_files/GE.pdf">Gaussova eliminační metoda</a>.</li>
</ul>
<p>Video s postupem Gaussovy eliminační metody:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=buhdFjMy7PU">Gaussova eliminační metoda</a></li>
</ul>
</div>
</div>
</div>
<p>Podstatou Gaussovy eliminační metody je úprava rozšířené matice soustavy <span class="math inline">\(A^*\)</span> do horního trojúhelníkového tvaru, tedy tvaru, kdy má matice pod hlavní diagonálou nuly. <span class="math display">\[
A^*=
\begin{pmatrix}
\begin{array}{ccccc|c}
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1(n-1)}&amp; a_{1n} &amp; b_1 \\
0 &amp; a_{22} &amp; \cdots &amp; a_{2(n-1)} &amp; a_{2n} &amp;b_2 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots&amp;\vdots \\
0 &amp; 0 &amp; \cdots &amp; a_{(n-1)(n-1)}&amp; a_{(n-1)n} &amp;b_n \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; a_{nn} &amp;b_n
\end{array}
\end{pmatrix}
\]</span> Tato část výpočtu se nazývá “přímý chod” a její složitost je řádově <span class="math inline">\(n^3\)</span>. Musíme totiž procházet celé řádky, sloupce a diagonálu, na níž jsou řídící prvky (pivot).</p>
<p>Vzhledem k tomu, že počítač se neumí rozhodovat jako my podle toho, jaká čísla se nám líbí. Proto musíme vždy vynulovat prvky pod řídícím prvkem tak, že odečteme od prvku pod pivotem příslušný násobek řídícího prvku, například pro <span class="math display">\[0 = a_{21} - \frac{a_{21}}{a_{11}}.\]</span></p>
<p>Všimněme si, že pokud bude řídící prvek nula, program by nám spadl, jelikož bychom dělili nulou. Proto existuje i verze tzv. Gaussova eliminační metoda s pivotací, kde toto ošetříme.</p>
<p>Ve druhé části, zvané “zpětný chod”, spočteme z matice v horním trojúhelníkovém tvaru jednotlivá řešení. Postupujeme přitom od posledního řádku, který symbolizuje rovnici <span class="math display">\[a_{nn}x_n = b_n\]</span>. Vyjádříme tedy <span class="math inline">\(x_n\)</span> takto <span class="math display">\[x_n = \frac{b_n}{a_{nn}}.\]</span> Následně se posuneme o řádek výše <span class="math display">\[a_{(n-1)(n-1)}x_{n-1} + a_{(n-1)n}x_{n} = b_{n-1}.\]</span> Toto upravíme do tvaru <span class="math display">\[x_{n-1} = \frac{b_{n-1}-a_{n-1}x_n}{a_{(n-1)(n-1)}}\]</span> a tak bychom pokračovali až k prvnímu řádku.</p>
<section id="gaussova-eliminační-metoda-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="gaussova-eliminační-metoda-v-jazyce-r">Gaussova eliminační metoda v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ================== VSTUPY ==================</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>( <span class="dv">10</span>, <span class="sc">-</span><span class="dv">2</span>,  <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>,  <span class="dv">2</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">3</span>,  <span class="dv">9</span>,  <span class="dv">1</span>,  <span class="dv">7</span>, <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">7</span>,  <span class="dv">3</span>,  <span class="dv">8</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>,  <span class="dv">7</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>,  <span class="dv">1</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">8</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">15</span>),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="sc">-</span><span class="fl">61.5</span>, <span class="sc">-</span><span class="fl">21.25</span>, <span class="sc">-</span><span class="fl">41.1</span>, <span class="fl">100.2</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(b)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Gaussova eliminace (bez pivotace)</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>GaussElimination <span class="ot">&lt;-</span> <span class="cf">function</span>(A, b) {</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(b)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  Ab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, b)  <span class="co"># rozšířená matice [A | b]</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PŘÍMÝ CHOD – vynulovat prvky pod diagonálou</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(N<span class="dv">-1</span>)) {</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(Ab[p,p]) <span class="sc">&lt;</span> .Machine<span class="sc">$</span>double.eps) <span class="fu">stop</span>(<span class="st">"Nulový pivot – použij pivotaci."</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (r <span class="cf">in</span> (p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>      m <span class="ot">&lt;-</span> Ab[r, p] <span class="sc">/</span> Ab[p, p]</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>      Ab[r, p<span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> Ab[r, p<span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>)] <span class="sc">-</span> m <span class="sc">*</span> Ab[p, p<span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ZPĚTNÝ CHOD</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  x[N] <span class="ot">&lt;-</span> Ab[N, N<span class="sc">+</span><span class="dv">1</span>] <span class="sc">/</span> Ab[N, N]</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (r <span class="cf">in</span> (N<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    x[r] <span class="ot">&lt;-</span> (Ab[r, N<span class="sc">+</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(Ab[r, (r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N] <span class="sc">*</span> x[(r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N])) <span class="sc">/</span> Ab[r, r]</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Gaussova eliminace s částečnou pivotací</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>GaussEliminationPivoting <span class="ot">&lt;-</span> <span class="cf">function</span>(A, b) {</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(b)</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>  Ab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, b)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PŘÍMÝ CHOD s pivotací po sloupcích</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(N<span class="dv">-1</span>)) {</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># najdi největší |pivot| ve sloupci p od řádku p dolů</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>    imax <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">abs</span>(Ab[p<span class="sc">:</span>N, p])) <span class="sc">+</span> p <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(Ab[imax, p]) <span class="sc">&lt;</span> .Machine<span class="sc">$</span>double.eps) <span class="fu">stop</span>(<span class="st">"Singulární matice."</span>)</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (imax <span class="sc">!=</span> p) {</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> Ab[p, ]</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>      Ab[p, ] <span class="ot">&lt;-</span> Ab[imax, ]</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>      Ab[imax, ] <span class="ot">&lt;-</span> tmp</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (r <span class="cf">in</span> (p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>      m <span class="ot">&lt;-</span> Ab[r, p] <span class="sc">/</span> Ab[p, p]</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>      Ab[r, p<span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> Ab[r, p<span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>)] <span class="sc">-</span> m <span class="sc">*</span> Ab[p, p<span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ZPĚTNÝ CHOD</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>  x[N] <span class="ot">&lt;-</span> Ab[N, N<span class="sc">+</span><span class="dv">1</span>] <span class="sc">/</span> Ab[N, N]</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (r <span class="cf">in</span> (N<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    x[r] <span class="ot">&lt;-</span> (Ab[r, N<span class="sc">+</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(Ab[r, (r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N] <span class="sc">*</span> x[(r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N])) <span class="sc">/</span> Ab[r, r]</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a><span class="co"># ====== SPOUŠTĚNÍ A KONTROLA ======</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bez pivotace:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bez pivotace:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">GaussElimination</span>(A, b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">S pivotací:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
S pivotací:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>xp <span class="ot">&lt;-</span> <span class="fu">GaussEliminationPivoting</span>(A, b)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Kontrola se solve():</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Kontrola se solve():</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">solve</span>(A, b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rezidua (měly by být ~0)</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">||Ax - b||2 (pivotace): "</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">sum</span>((A <span class="sc">%*%</span> xp <span class="sc">-</span> b)<span class="sc">^</span><span class="dv">2</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
||Ax - b||2 (pivotace): 2.622519e-13</code></pre>
</div>
</div>
</section>
</section>
<section id="metoda-lu-rozkladu" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="metoda-lu-rozkladu"><span class="header-section-number">3.3</span> Metoda LU rozkladu</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="http://kfe.fjfi.cvut.cz/~vachal/edu/nme/cviceni/02_linalg/DOCS/teorie_LU_dekompozice.pdf">LU dekompozice</a>,</li>
<li><a href="https://is.muni.cz/el/1431/podzim2011/M1VM01/um/rozklady.dokumentace.pdf">Maticové rozklady</a> na straně 7.</li>
</ul>
<p>Video s postupem LU rozkladu:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=JP2j8NY5jwE">Lineární algebra - LU rozklad</a></li>
</ul>
</div>
</div>
</div>
<p>LU rozklad (nebo také LU dekompozice) je metoda řešení soustavy lineárních rovnic. Tato metoda je postavena na následující definici:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definice LU rozkladu
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mějme regulární čtvercovou matici <span class="math inline">\(A\)</span> nad libovolným tělesem, u které není třeba při Gaussově eliminaci prohazovat řádky. Pak existují také regulární matice <span class="math inline">\(L\)</span> a <span class="math inline">\(U\)</span>, jsou určený jednoznačně a platí pro ně následující tvrzení:</p>
<ul>
<li><span class="math inline">\(A = L \cdot U\)</span></li>
<li><span class="math inline">\(L\)</span> je dolní trojúhelníková matice s jedničkami na celé hlavní diagonále</li>
<li><span class="math inline">\(U\)</span> je horní trojúhelníková matice s nenulovými prvky na hlavní diagonále.</li>
</ul>
</div>
</div>
<p>Z této definice plyne, že z našich čtvercových matic, s nimiž budeme pracovat, můžeme vytvořit součin dvou matic v trojúhelníkových tvarech.</p>
<p>Tato metoda ovšem není vhodná vždy, k jejímu vytvoření potřebujeme zpracovat původní matici <span class="math inline">\(A\)</span>, takže tento krok nemůžeme přeskočit. Je tedy vhodné ji využít v moment, kdy se nám bude měnit pouze vektor pravých stran <span class="math inline">\(\vec{b}\)</span>.</p>
<p><span class="math display">\[
A =
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; \cdots &amp; a_{2n} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; a_{3n} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn}
\end{pmatrix} =
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
l_{21} &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
l_{31} &amp; l_{32} &amp; 1 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
l_{n1} &amp; l_{n2} &amp; l_{n3} &amp; \cdots &amp; 1
\end{pmatrix}
\begin{pmatrix}
u_{11} &amp; u_{12} &amp; u_{13} &amp; \cdots &amp; u_{1n} \\
0 &amp; u_{22} &amp; u_{23} &amp; \cdots &amp; u_{2n} \\
0 &amp; 0 &amp; u_{33} &amp; \cdots &amp; u_{3n} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; u_{nn}
\end{pmatrix} = LU
\]</span></p>
<p>Výpočet pomocí těchto pomocných matic pak probíhá díky substituci <span class="math inline">\(A = LU\)</span> <span class="math display">\[A\vec{x}=\vec{b}\]</span> <span class="math display">\[(LU)\vec{x}=\vec{b}\]</span> <span class="math display">\[L(U\vec{x}) = \vec{b},\]</span> kde použijeme substituci <span class="math inline">\(U\vec{x} = \vec{y}\)</span>. Dostaneme tak <span class="math display">\[
L\vec{y} = \vec{b}
\]</span></p>
<p>V čem je tedy výhodné řešit soustavu pomocí LU dekompozice? Výhodnost se skrývá ve složitosti výpočtu z trojúhelníkových matic, ta je řádově pouze <span class="math inline">\(n^2\)</span> (u řešení pomocí Gaussovy eliminační metody je složitost <span class="math inline">\(n^3\)</span>). Tato výhoda plyne z faktu, že máme trojúhelníkové matice, na které je potřeba pouze aplikovat zpětný chod z Gaussovy eliminační metody.</p>
<section id="zjištění-lu-rozkladu-při-přímém-chodu-gaussovy-eliminační-metody-na-příkladu" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="zjištění-lu-rozkladu-při-přímém-chodu-gaussovy-eliminační-metody-na-příkladu">Zjištění LU rozkladu při přímém chodu Gaussovy eliminační metody na příkladu</h3>
<p>Mějme matici <span class="math display">\[
A =
\begin{pmatrix}
\begin{array}{ccc|c}
2 &amp; -3 &amp; 11 &amp; 43  \\
7 &amp; 2 &amp; -8 &amp; -5 \\
-5 &amp; 1 &amp; 0 &amp; -20
\end{array}
\end{pmatrix}
\]</span></p>
<p>nyní budeme postupovat v duchu přímého chodu Gaussovy eliminace, tedy zvolíme číslo 2 jako řídící prvek a budeme nulovat prvky pod ním. Zvolíme tedy vhodný násobek, abychom vynulovali číslo 7, to bude <span class="math inline">\(k =\frac{7}{2} = 3,5\)</span> a následně odečteme <span class="math inline">\(k\)</span>-násobek prvního řádku od druhého řádku. A takto budeme postupovat dále, dokud nedosáhneme horního trojúhelníkového tvaru, budeme si pamatovat tato <span class="math inline">\(k\)</span>, která nám následně matici <span class="math inline">\(L\)</span>.</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; -3 &amp; 11\\
7 &amp; 2 &amp; -8\\
-5 &amp; 1 &amp; 0
\end{pmatrix} \sim
\begin{pmatrix}
2 &amp; -3 &amp; 11 &amp;\\
0 &amp; 12,5 &amp; -46,5\\
-5 &amp; 1 &amp; 0
\end{pmatrix} \sim \cdots \sim
\begin{pmatrix}
2 &amp; -3 &amp; 11\\
0 &amp; 12,5 &amp; -46,5\\
0 &amp; 0 &amp; 3,32
\end{pmatrix}
\]</span></p>
<p>Nyní zavedeme matice <span class="math inline">\(L\)</span> a <span class="math inline">\(U\)</span>. Matice <span class="math inline">\(U\)</span> bude matice <span class="math inline">\(A\)</span>, kterou jsme takto upravili do horního trojúhelníkového tvaru.</p>
<p><span class="math display">\[
U = \begin{pmatrix}
2 &amp; -3 &amp; 11\\
0 &amp; 12,5 &amp; -46,5\\
0 &amp; 0 &amp; 3,32
\end{pmatrix}
\]</span></p>
<p>Matici <span class="math inline">\(L\)</span> vytvoříme pomocí oněch čísel <span class="math inline">\(k\)</span>, která jsme používali k úpravám matice <span class="math inline">\(A\)</span>.</p>
<p><span class="math display">\[
L =
\begin{pmatrix}
1 &amp; 0 &amp; 0  \\
3,5 &amp; 1 &amp; 0 \\
-2,5 &amp; -0,52 &amp; 1
\end{pmatrix}
\]</span></p>
<p>Pokud bychom teď chtěli ověřit, že jsme LU rozklad provedli správně, vrátili bychom se k první rovnici <span class="math inline">\(LU = A\)</span>. <span class="math display">\[
LU = \begin{pmatrix}
1 &amp; 0 &amp; 0  \\
3,5 &amp; 1 &amp; 0 \\
-2,5 &amp; -0,52 &amp; 1
\end{pmatrix}
\begin{pmatrix}
2 &amp; -3 &amp; 11\\
0 &amp; 12,5 &amp; -46,5\\
0 &amp; 0 &amp; 3,32
\end{pmatrix} =
\begin{pmatrix}
2 &amp; -3 &amp; 11\\
7 &amp; 2 &amp; -8\\
-5 &amp; 1 &amp; 0
\end{pmatrix} = A
\]</span></p>
</section>
<section id="metoda-lu-rozkladu-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="metoda-lu-rozkladu-v-jazyce-r">Metoda LU rozkladu v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ================== VSTUPY ==================</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>( <span class="dv">10</span>, <span class="sc">-</span><span class="dv">2</span>,  <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>,  <span class="dv">2</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">3</span>,  <span class="dv">9</span>,  <span class="dv">1</span>,  <span class="dv">7</span>, <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">7</span>,  <span class="dv">3</span>,  <span class="dv">8</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>,  <span class="dv">7</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>,  <span class="dv">1</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">8</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">15</span>),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="sc">-</span><span class="fl">61.5</span>, <span class="sc">-</span><span class="fl">21.25</span>, <span class="sc">-</span><span class="fl">41.1</span>, <span class="fl">100.2</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ================== FUNKCE LU ROZKLAD ==================</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>LUrozklad <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">dim</span>(A)[<span class="dv">1</span>]</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  LU <span class="ot">&lt;-</span> A</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Přímý chod pro rozklad A = L·U</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(N<span class="dv">-1</span>)) {</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (r <span class="cf">in</span> (p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>      u <span class="ot">&lt;-</span> LU[r, p] <span class="sc">/</span> LU[p, p]     <span class="co"># eliminační faktor</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>      LU[r, (p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N] <span class="ot">&lt;-</span> LU[r, (p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N] <span class="sc">-</span> u <span class="sc">*</span> LU[p, (p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>      LU[r, p] <span class="ot">&lt;-</span> u                <span class="co"># uložíme faktor do dolní části matice (L)</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LU)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="co"># ================== </span><span class="al">TEST</span><span class="co"> A KONTROLA ==================</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>LU <span class="ot">&lt;-</span> <span class="fu">LUrozklad</span>(A)</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Rozšířená matice LU (L + U v jedné matici):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Rozšířená matice LU (L + U v jedné matici):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(LU, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]   [,2]   [,3]   [,4]   [,5]
[1,] 10.0 -2.000  3.000 -1.000  2.000
[2,] -0.3  8.400  1.900  6.700 -1.400
[3,]  0.2 -0.071 -7.464  3.679  7.500
[4,]  0.1  0.857  0.928  0.943 -4.962
[5,] -0.2  0.310 -1.073 -2.467 11.643</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Oddělení L a U pro přehled</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(LU)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, N)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, N)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">&gt;</span> j) L[i, j] <span class="ot">&lt;-</span> LU[i, j]</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> U[i, j] <span class="ot">&lt;-</span> LU[i, j]</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Matice L:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Matice L:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(L, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]   [,2]   [,3]   [,4] [,5]
[1,]  1.0  0.000  0.000  0.000    0
[2,] -0.3  1.000  0.000  0.000    0
[3,]  0.2 -0.071  1.000  0.000    0
[4,]  0.1  0.857  0.928  1.000    0
[5,] -0.2  0.310 -1.073 -2.467    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Matice U:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Matice U:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(U, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]   [,3]   [,4]   [,5]
[1,]   10 -2.0  3.000 -1.000  2.000
[2,]    0  8.4  1.900  6.700 -1.400
[3,]    0  0.0 -7.464  3.679  7.500
[4,]    0  0.0  0.000  0.943 -4.962
[5,]    0  0.0  0.000  0.000 11.643</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kontrola – rekonstrukce A ≈ L·U</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Kontrola L·U:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Kontrola L·U:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(L <span class="sc">%*%</span> U, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]   10   -2    3   -1    2
[2,]   -3    9    1    7   -2
[3,]    2   -1   -7    3    8
[4,]    1    7   -5   10    1
[5,]   -2    3    8   -4   15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Původní A:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Původní A:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]   10   -2    3   -1    2
[2,]   -3    9    1    7   -2
[3,]    2   -1   -7    3    8
[4,]    1    7   -5   10    1
[5,]   -2    3    8   -4   15</code></pre>
</div>
</div>
</section>
</section>
<section id="jacobiho-metoda" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="jacobiho-metoda"><span class="header-section-number">3.4</span> Jacobiho metoda</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/nmFelcman.pdf">Numerická matematika</a> na straně 37,</li>
<li><a href="https://math.fce.vutbr.cz/vyuka/matematika/numericke_metody/node12.html">Jacobiova metoda</a>.</li>
</ul>
</div>
</div>
</div>
<p>Jacobiho metoda patří mezi iterační metody řešení soustav lineárních rovnic, tedy metody zpřesňující opakovaně svůj odhad. Jako u zbytku metod řešíme rovnici <span class="math inline">\(A\vec{x} = \vec{b}\)</span>. Metoda konverguje tehdy, když je matice <span class="math inline">\(A\)</span> diagonálně dominantní nebo pozitivně definitní.</p>
<p>Diagonálně dominantní je matice (o rozměru <span class="math inline">\(n\times n\)</span>) právě tehdy, když platí <span class="math display">\[
\forall i \in \{1, 2, \cdots, n\};\;|a_{ii}| \geq \sum_{\substack{i = 1 \\ j \neq i}}^n |a_{ij}|.
\]</span> Pozitivní definitnost matice můžeme ověřit například pomocí Sylvestrova kritéria. To spočívá ve výpočtu determinantů všech hlavních vedoucích podmatic. Mějme matici <span class="math display">\[
A =
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn}
\end{pmatrix}
\]</span> Matice <span class="math inline">\(A\)</span> je pozitivně definitní, pokud bude každý z následujících determinantů kladný. <span class="math display">\[
\det(a_{11}),\;
\det \begin{pmatrix}
a_{11} &amp; a_{12} \\
a_{21} &amp; a_{22}
\end{pmatrix},\; \cdots, \;
\det \begin{pmatrix}
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn}
\end{pmatrix}.
\]</span></p>
<p>Mějme regulární čtvercovou matici <span class="math inline">\(A\)</span>, pro kterou platí <span class="math inline">\(A = L+D+U\)</span>, kde je <span class="math inline">\(L\)</span> ostře dolní trojúhelníková matice, <span class="math inline">\(D\)</span> diagonální matice a <span class="math inline">\(U\)</span> ostře horní trojúhelníková matice.</p>
<p><span class="math display">\[
A =
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; \cdots &amp; a_{2n} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; a_{3n} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn}
\end{pmatrix},
\]</span> <span class="math display">\[
L =
\begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
a_{21} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
a_{31} &amp; a_{32} &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; 0
\end{pmatrix},
D =
\begin{pmatrix}
a_{11} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; a_{22} &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; 0 &amp; a_{33} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; a_{nn}
\end{pmatrix},
U =
\begin{pmatrix}
0 &amp; a_{12} &amp; a_{13} &amp; \cdots &amp; a_{1n} \\
0 &amp; 0 &amp; a_{23} &amp; \cdots &amp; a_{2n} \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; a_{3n} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0
\end{pmatrix}.
\]</span></p>
<p>Nyní můžeme soustavu rovnic vyjádřit jako <span class="math display">\[
A\vec{x} =(L+D+U)\vec{x} = \vec{b}
\]</span> Pomocí následujících úprav si vyjádříme vektor řešení <span class="math inline">\(\vec{x}\)</span>. <span class="math display">\[
D\vec{x} = \vec{b} - (L+U)\vec{x}
\]</span> <span class="math display">\[
\vec{x} = D^{-1} [\vec{b} - (L+U)\vec{x}]
\]</span> Takto jsme si vyjádřili nový odhad pomocí starého, můžeme přeznačit <span class="math display">\[
\vec{x^{(k+1)}} = D^{-1} [\vec{b} - (L+U)\vec{x^{(k)}}]
\]</span></p>
<p>Rozepišme tento zápis. <span class="math display">\[
\begin{pmatrix}
x_1^{(k+1)} \\
x_2^{(k+1)} \\
\vdots \\
x_n^{(k+1)}
\end{pmatrix} =
\begin{pmatrix}
\frac{1}{a_{11}} &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \frac{1}{a_{22}} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \frac{1}{a_{nn}}
\end{pmatrix} \left[
\begin{pmatrix}
b_1 \\
b_2 \\
\vdots \\
b_n
\end{pmatrix} -
\begin{pmatrix}
0 &amp; a_{12} &amp; a_{13} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; 0 &amp; a_{23} &amp; \cdots &amp; a_{2n} \\
a_{31} &amp; a_{32} &amp; 0 &amp; \cdots &amp; a_{3n} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1^{(k)} \\
x_2^{(k)} \\
\vdots \\
x_n^{(k)}
\end{pmatrix}
\right]
\]</span> Nyní toto zapíšeme pro jednu složku. <span class="math display">\[
x_i^{(k+1)} = \frac{1}{a_{ii}} \left[b_1 - \sum_{\substack{j = 1\\ j \neq i}}^n a_{ij}x_j^{(k)} \right]
\]</span> A následně můžeme zapsat celou soustavu jako</p>
<p><span class="math display">\[
\begin{align*}
x_1^{(k+1)} &amp;= \frac{b_1 - a_{12}x_2^{(k)} - a_{13}x_3^{(k)} - \cdots - a_{1(n-1)}x_{(n-1)}^{(k)} - a_{1n}x_n^{(k)}}{a_{11}}\\
x_2^{(k+1)} &amp;= \frac{b_2 - a_{21}x_1^{(k)} - a_{23}x_3^{(k)} - \cdots - a_{2(n-1)}x_{(n-1)}^{(k)} - a_{2n}x_n^{(k)}}{a_{22}}\\
&amp;\vdots\\
x_n^{(k+1)} &amp;= \frac{b_n - a_{n1}x_1^{(k)} - a_{n2}x_2^{(k)} - \cdots - a_{n(n-1)}x_{(n-1)}^{(k)}}{a_{nn}}.\end{align*}
\]</span></p>
<section id="jacobiho-metoda-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="jacobiho-metoda-v-jazyce-r">Jacobiho metoda v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ================== VSTUPY (5×5) ==================</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>( <span class="dv">10</span>, <span class="sc">-</span><span class="dv">2</span>,  <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>,  <span class="dv">2</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">3</span>,  <span class="dv">9</span>,  <span class="dv">1</span>,  <span class="dv">7</span>, <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">7</span>,  <span class="dv">3</span>,  <span class="dv">8</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>,  <span class="dv">7</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>,  <span class="dv">1</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">8</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">15</span>),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="sc">-</span><span class="fl">61.5</span>, <span class="sc">-</span><span class="fl">21.25</span>, <span class="sc">-</span><span class="fl">41.1</span>, <span class="fl">100.2</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ================== Jacobi — skalárně ==================</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>Jacobi <span class="ot">&lt;-</span> <span class="cf">function</span>(A, b, <span class="at">maxiter =</span> <span class="dv">10000</span>, <span class="at">eps =</span> <span class="fl">1e-10</span>){</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(b)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  xold <span class="ot">&lt;-</span> xnew <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">diag</span>(A)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">abs</span>(d) <span class="sc">&lt;</span> .Machine<span class="sc">$</span>double.eps)) <span class="fu">stop</span>(<span class="st">"Nulový prvek na diagonále."</span>)</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxiter){</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>      s <span class="ot">&lt;-</span> b[i] <span class="sc">-</span> <span class="fu">sum</span>(A[i, <span class="sc">-</span>i] <span class="sc">*</span> xold[<span class="sc">-</span>i])</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>      xnew[i] <span class="ot">&lt;-</span> s <span class="sc">/</span> d[i]</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    err <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((xnew <span class="sc">-</span> xold)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(err)) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (err <span class="sc">&lt;</span> eps){</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Number of iterations (Jacobi):"</span>, iter, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(xnew)</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    xold <span class="ot">&lt;-</span> xnew</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Nedosáhla se konvergence v zadaném počtu iterací."</span>)</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>  xnew</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ================== Jacobi — maticově (bez mutace A) ==================</span></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>JacobiVer2 <span class="ot">&lt;-</span> <span class="cf">function</span>(A, b, <span class="at">maxiter =</span> <span class="dv">10000</span>, <span class="at">eps =</span> <span class="fl">1e-10</span>){</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(b)</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">diag</span>(A))         <span class="co"># diagonální část</span></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> A <span class="sc">-</span> D                 <span class="co"># zbytek (A bez diagonály)</span></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">diag</span>(D)</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">abs</span>(d) <span class="sc">&lt;</span> .Machine<span class="sc">$</span>double.eps)) <span class="fu">stop</span>(<span class="st">"Nulový prvek na diagonále."</span>)</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Předpočítáme D^{-1}</span></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>  Dinv <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> d)</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>  xold <span class="ot">&lt;-</span> xnew <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxiter){</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x^{k+1} = D^{-1} (b - R x^k)</span></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>    xnew <span class="ot">&lt;-</span> Dinv <span class="sc">%*%</span> (b <span class="sc">-</span> R <span class="sc">%*%</span> xold)</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>    err <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((xnew <span class="sc">-</span> xold)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(err)) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (err <span class="sc">&lt;</span> eps){</span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Number of iterations (JacobiVer2):"</span>, iter, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">drop</span>(xnew))</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>    xold <span class="ot">&lt;-</span> xnew</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Nedosáhla se konvergence v zadaném počtu iterací."</span>)</span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop</span>(xnew)</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ================== SPUŠTĚNÍ A KONTROLA ==================</span></span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); x1 <span class="ot">&lt;-</span> <span class="fu">Jacobi</span>(A, b); te <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of iterations (Jacobi): 1158 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Trvání Jacobi: "</span>, <span class="fu">as.numeric</span>(te <span class="sc">-</span> tb), <span class="st">" s</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trvání Jacobi: 0.01562977 s</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); x2 <span class="ot">&lt;-</span> <span class="fu">JacobiVer2</span>(A, b); te <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of iterations (JacobiVer2): 1158 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Trvání JacobiVer2: "</span>, <span class="fu">as.numeric</span>(te <span class="sc">-</span> tb), <span class="st">" s</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trvání JacobiVer2: 0.01129198 s</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Kontrola se solve():</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Kontrola se solve():</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>x_true <span class="ot">&lt;-</span> <span class="fu">solve</span>(A, b); <span class="fu">print</span>(x_true)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">||Ax - b||2 (Jacobi):     "</span>, <span class="fu">sqrt</span>(<span class="fu">sum</span>((A <span class="sc">%*%</span> x1 <span class="sc">-</span> b)<span class="sc">^</span><span class="dv">2</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
||Ax - b||2 (Jacobi):     8.940968e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"||Ax - b||2 (JacobiVer2): "</span>, <span class="fu">sqrt</span>(<span class="fu">sum</span>((A <span class="sc">%*%</span> x2 <span class="sc">-</span> b)<span class="sc">^</span><span class="dv">2</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>||Ax - b||2 (JacobiVer2): 8.940104e-10</code></pre>
</div>
</div>
</section>
</section>
<section id="gaussova-seidelova-metoda" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="gaussova-seidelova-metoda"><span class="header-section-number">3.5</span> Gaussova-Seidelova metoda</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/nmFelcman.pdf">Numerická matematika</a> na stranách 37-39,</li>
<li><a href="https://math.fce.vutbr.cz/vyuka/matematika/numericke_metody/node13.html">Gaussova-Seidelova metoda</a>.</li>
</ul>
<p>Video s ukázkou výpočtu naleznete zde: - <a href="https://www.youtube.com/watch?v=F6J3ZmXkMj0">The Gauss-Seidel Method</a>.</p>
</div>
</div>
</div>
<p>Gaussova-Seidelova metoda je také metodou iterační a vychází ze stejné úvahy spočívající v rozdělení matice <span class="math inline">\(A\)</span> na tři matice (ostře dolní trojúhelníkovou, diagonální a ostře horní trojúhelníkovou), tedy <span class="math display">\[
A\vec{x} = (L+D+U)\vec{x} = \vec{b}.
\]</span> Úprava ovšem probíhá jinak, nejdříve upravíme do tvaru <span class="math display">\[
(L+D)\vec{x} = \vec{b} - U\vec{x}.
\]</span> Nicméně nyní bychom museli k osamocení vektoru <span class="math inline">\(\vec{x}\)</span> vynásobit rovnici inverzní maticí k matici <span class="math inline">\(L+U\)</span> a dostali bychom <span class="math display">\[
\vec{x} = (L+D)^{-1} \left[ \vec{b} - U\vec{x}\right],
\]</span> ale hledání inverzní matice k takové matici by mělo příliš velikou složitost, takže zvolíme úpravu <span class="math display">\[
L\vec{x^{(k+1)}} + D\vec{x^{(k+1)}} = \vec{b} - U\vec{x^k}.
\]</span> <span class="math display">\[
D\vec{x^{(k+1)}} = \vec{b} - U\vec{x^k} - L\vec{x^{(k+1)}}
\]</span> <span class="math display">\[
\vec{x^{(k+1)}} = D^{-1} \left[\vec{b} - (L\vec{x^{(k+1)}} + U\vec{x^k}) \right]
\]</span></p>
<p>Pro pochopení rozdílu si opět tento vzorec přepišme do tvaru <span class="math display">\[
\begin{align*}
&amp;\begin{pmatrix}
x_1^{(k+1)} \\
x_2^{(k+1)} \\
\vdots \\
x_n^{(k+1)}
\end{pmatrix}
=
\begin{pmatrix}
\frac{1}{a_{11}} &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \frac{1}{a_{22}} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots&amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \frac{1}{a_{nn}}
\end{pmatrix}
\left[
\begin{pmatrix}
b_1 \\ b_2 \\ \vdots \\ b_n
\end{pmatrix}
-
\begin{pmatrix}
0 &amp; 0 &amp; 0&amp; \cdots &amp; 0 \\
a_{21} &amp; 0&amp;0 &amp; \cdots &amp; 0 \\
a_{31} &amp; a_{32} &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp;a_{n3} &amp; \cdots &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1^{(k+1)} \\ x_2^{(k+1)} \\ \vdots \\ x_n^{(k+1)}
\end{pmatrix} \right. \\
&amp; \hspace{2cm}
\left. +
\begin{pmatrix}
0 &amp; a_{12} &amp; a_{13} &amp; \cdots &amp; a_{1n}\\
0 &amp; 0 &amp; a_{23} &amp; \cdots &amp; a_{2n}\\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; a_{3n}\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; a_{nn}
\end{pmatrix}
\begin{pmatrix}
x_1^{(k)} \\
x_2^{(k)} \\
\vdots \\
x_n^{(k)}
\end{pmatrix}
\right]
\end{align*}
\]</span> Hlavní výhodou, kterou vidíme v tomto zápise, je jednodušší výpočet. Trojúhelníkové matice se totiž násobí lépe.</p>
<section id="gaussova-seidelova-metoda-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="gaussova-seidelova-metoda-v-jazyce-r">Gaussova-Seidelova metoda v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ============== VSTUPY (5×5) ==============</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>( <span class="dv">10</span>, <span class="sc">-</span><span class="dv">2</span>,  <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>,  <span class="dv">2</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">3</span>,  <span class="dv">9</span>,  <span class="dv">1</span>,  <span class="dv">7</span>, <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">7</span>,  <span class="dv">3</span>,  <span class="dv">8</span>,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>,  <span class="dv">7</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>,  <span class="dv">1</span>,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">8</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">15</span>),</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="sc">-</span><span class="fl">61.5</span>, <span class="sc">-</span><span class="fl">21.25</span>, <span class="sc">-</span><span class="fl">41.1</span>, <span class="fl">100.2</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ============== Gauss–Seidel (klasická implementace) ==============</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>GS <span class="ot">&lt;-</span> <span class="cf">function</span>(A, b, <span class="at">maxiter =</span> <span class="dv">10000</span>, <span class="at">eps =</span> <span class="fl">1e-10</span>){</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(b)</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  xold <span class="ot">&lt;-</span> x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">diag</span>(A)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">abs</span>(d) <span class="sc">&lt;</span> .Machine<span class="sc">$</span>double.eps)) <span class="fu">stop</span>(<span class="st">"Nulový prvek na diagonále."</span>)</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxiter){</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># součet s aktuálně nejnovějšími hodnotami x (Gauss–Seidel update in-place)</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>      s <span class="ot">&lt;-</span> b[i] <span class="sc">-</span> <span class="fu">sum</span>(A[i, <span class="sc">-</span>i] <span class="sc">*</span> x[<span class="sc">-</span>i])</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> s <span class="sc">/</span> d[i]</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>    err <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((x <span class="sc">-</span> xold)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(err)) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (err <span class="sc">&lt;</span> eps){</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Number of iterations (Gauss-Seidel):"</span>, iter, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x)</span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>    xold <span class="ot">&lt;-</span> x</span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Nedosáhla se konvergence v zadaném počtu iterací."</span>)</span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a><span class="co"># ============== Gauss–Seidel (kompaktní varianta) ==============</span></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a><span class="co"># x^{k+1} = (D + L)^{-1} (b - U x^{k}), kde A = D + L + U</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>GS_variant <span class="ot">&lt;-</span> <span class="cf">function</span>(A, b, <span class="at">maxiter =</span> <span class="dv">10000</span>, <span class="at">eps =</span> <span class="fl">1e-10</span>){</span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(b)</span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">diag</span>(A))</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> A <span class="sc">-</span> D</span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, N); U[<span class="fu">upper.tri</span>(A)] <span class="ot">&lt;-</span> A[<span class="fu">upper.tri</span>(A)]  <span class="co"># horní část</span></span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> L <span class="sc">-</span> U                                               <span class="co"># dolní část (striktně pod diag)</span></span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">abs</span>(<span class="fu">diag</span>(D)) <span class="sc">&lt;</span> .Machine<span class="sc">$</span>double.eps)) <span class="fu">stop</span>(<span class="st">"Nulový prvek na diagonále."</span>)</span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> D <span class="sc">+</span> L                        <span class="co"># (D+L)</span></span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>  Minv <span class="ot">&lt;-</span> <span class="fu">solve</span>(M)                  <span class="co"># můžeme i LU rozklad, ale solve je pro N=5 OK</span></span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a>  xold <span class="ot">&lt;-</span> x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxiter){</span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> Minv <span class="sc">%*%</span> (b <span class="sc">-</span> U <span class="sc">%*%</span> x)     <span class="co"># jeden GS krok maticově</span></span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a>    err <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((x <span class="sc">-</span> xold)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(err)) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (err <span class="sc">&lt;</span> eps){</span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Number of iterations (GS_variant):"</span>, iter, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">drop</span>(x))</span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb86-59"><a href="#cb86-59" aria-hidden="true" tabindex="-1"></a>    xold <span class="ot">&lt;-</span> x</span>
<span id="cb86-60"><a href="#cb86-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-61"><a href="#cb86-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Nedosáhla se konvergence v zadaném počtu iterací."</span>)</span>
<span id="cb86-62"><a href="#cb86-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop</span>(x)</span>
<span id="cb86-63"><a href="#cb86-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-64"><a href="#cb86-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-65"><a href="#cb86-65" aria-hidden="true" tabindex="-1"></a><span class="co"># ============== SPUŠTĚNÍ A KONTROLA ==============</span></span>
<span id="cb86-66"><a href="#cb86-66" aria-hidden="true" tabindex="-1"></a>x_gs <span class="ot">&lt;-</span> <span class="fu">GS</span>(A, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of iterations (Gauss-Seidel): 578 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>x_gsv <span class="ot">&lt;-</span> <span class="fu">GS_variant</span>(A, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of iterations (GS_variant): 578 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>x_true <span class="ot">&lt;-</span> <span class="fu">solve</span>(A, b)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Řešení (Gauss–Seidel):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(x_gs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Řešení (Gauss–Seidel):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Řešení (GS_variant):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(x_gsv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Řešení (GS_variant):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Řešení (solve):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(x_true)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Řešení (solve):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -31.62165 -104.73723   70.60815  106.26325   14.09042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">||Ax - b||2  (GS)        = %.6e</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">sqrt</span>(<span class="fu">sum</span>((A <span class="sc">%*%</span> x_gs  <span class="sc">-</span> b)<span class="sc">^</span><span class="dv">2</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
||Ax - b||2  (GS)        = 5.638337e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"||Ax - b||2  (GS_variant)= %.6e</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">sqrt</span>(<span class="fu">sum</span>((A <span class="sc">%*%</span> x_gsv <span class="sc">-</span> b)<span class="sc">^</span><span class="dv">2</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>||Ax - b||2  (GS_variant)= 5.639454e-10</code></pre>
</div>
</div>
</section>
</section>
<section id="rozdíl-mezi-jacobiho-a-gaussovou-seidelovou-metodou" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="rozdíl-mezi-jacobiho-a-gaussovou-seidelovou-metodou"><span class="header-section-number">3.6</span> Rozdíl mezi Jacobiho a Gaussovou-Seidelovou metodou</h2>
<p>Obě metody vychází ze stejné počáteční úpravy pomocí dvou ostře trojúhelníkových a diagonální matice. A ačkoli je v úpravě do finální podoby u obou metod pouze jedna odlišnost, je pro výpočetní rychlost důležitá.</p>
<p>Gaussova-Seidelova metoda je právě kvůli tomuto jednomu rozdílu rychlejší. To souvisí s použitím trojúhelníkových matic místo jejich součtu. Součet těchto mětic je totiž náročnější na násobení než postupné násobení jedné a následně druhé matice vektorem.</p>
<p>Dalším rozdílem je potřebná paměť pro vykonání těchto metod.Při použití Jacobiho metody je potřeba si zapamatovat celý vektor <span class="math inline">\(x^{(k)}\)</span> pro výpočet nové iterace <span class="math inline">\(x^{(k+1)}\)</span>. Oproti tomu u Gaussovy-Seidelovy metody potřebujeme rezervovat místo pouze pro jeden vektor <span class="math inline">\(x^{(k)}\)</span>, na jehož místo se postupně ukládají složky vektoru <span class="math inline">\(x^{(k+1)}\)</span>. Často si ovšem budeme chtít zapamatovat i celý předchozí vektor, kvůli kontrole přesnosti aktuální iterace.</p>
</section>
</section>
<section id="interpolace" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Interpolace</h1>
<p>S funkcemi se potýkáme již od základní školy. Některé jsou zadané předpisem, jiné grafem. Je ale také možné, že je nám funkce zadána pomocí tabulky hodnot, tedy několika bodů. Cílem interpolace je tedy vytvořit křivku, která bude zadanými body procházet a bude co nejhladší.</p>
<p>V praxi můžeme interpolaci využít, budeme-li mít omezený počet naměřených hodnot a budeme chtít předvídat vývoj dalších měření nebo vývoj mezi naměřenými hodnotami. Pochopitelné je, že čím více budeme mít naměřených hodnot, tím přesnější bude křivka, kterou je proložíme.</p>
<section id="volba-bodů-k-interpolaci" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="volba-bodů-k-interpolaci"><span class="header-section-number">4.1</span> Volba bodů k interpolaci</h2>
<p>Zvolme si tyto body, které se v následujících metodách budeme snažit proložit křivkou.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="NUM_public_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lineární-interpolace-po-částech" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="lineární-interpolace-po-částech"><span class="header-section-number">4.2</span> Lineární interpolace po částech</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="https://geo.mff.cuni.cz/~lh/nofy056/prednaska/02-NR.pdf">Numerické recepty</a> na straně 5.</li>
</ul>
<p>Videa s vizualizací a dalším vysvětlením metody najdete zde:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=mZuqOYjxymU&amp;t=180s">Lineární interpolace</a>,</li>
<li><a href="https://cs.khanacademy.org/computing/pixar/animate/parametric-curves/v/animation-5">Matematika za lineární interpolací</a>.</li>
</ul>
</div>
</div>
</div>
<p>Lineární interpolace po částech je nejjednodušším proložením bodů křivkou. Body totiž proložíme lomenou křivkou, stačí tedy spojit nejbližší dva body úsečkou. Ale pozor musí si být nejbližší svými souřadnicemi na ose <span class="math inline">\(x\)</span>, nikoli vzdáleností bodů. Jinak by se totiž mohlo stát, že se budeme vracet zpět a neproložíme tak body funkcí (v jednom bodě bude mít dvě různé funkční hodnoty).</p>
<section id="lineární-interpolace-po-částech-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="lineární-interpolace-po-částech-v-jazyce-r">Lineární interpolace po částech v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zde bude kód</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="interpolace-polynomem-v-lagrangeově-tvaru" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="interpolace-polynomem-v-lagrangeově-tvaru"><span class="header-section-number">4.3</span> Interpolace polynomem v Lagrangeově tvaru</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="https://kma.fp.tul.cz/images/stories/vyuka/cerna-matematika3-fs/interpolace.pdf">Interpolace</a> na stranách 3-7,</li>
<li><a href="http://kfe.fjfi.cvut.cz/~klimo/nm/l6.pdf">Aproximace funkcí</a> na stranách 1-3.</li>
</ul>
</div>
</div>
</div>
<p>Mějme výchozí situaci, na níž si vysvětlíme interpolaci polynomem v Lagrangově tvaru.</p>
<div class="columns">
<div class="column" style="width:45%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lagrange.jpg" class="img-fluid figure-img"></p>
<figcaption>Výchozí situace pro interpolaci</figcaption>
</figure>
</div>
</div><div class="column" style="width:13%;">

</div><div class="column" style="width:42%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lagrange_new.jpg" class="img-fluid figure-img"></p>
<figcaption>Nové body k interpolaci</figcaption>
</figure>
</div>
</div>
</div>
<p>Potřebujeme proložit body <span class="math inline">\(A,B,C,D\)</span> polynomem. Víme, že <span class="math inline">\(n\)</span> bodů proložíme polynomem stupně <span class="math inline">\(n-1\)</span>.</p>
<p>Tento způsob interpolace vychází z předpokladu, že naprosto bezpečně umíme proložit polynomem stupně <span class="math inline">\(n-1\)</span> body <span class="math inline">\(x_0, x_1, x_2\)</span>, které leží na ose <span class="math inline">\(x\)</span>. Takový polynom bude vypadat takto <span class="math display">\[(x-x_0)(x-x_1)(x-x_2).\]</span> Nyní potřebujeme tento polynom upravit tak, abychom zachovali jeho stupeň a zároveň procházel bode <span class="math inline">\(D\)</span>. Pro jednoduchost si označíme <span class="math inline">\(D[x_3, y_3]\)</span>. Řešíme tedy podmínku <span class="math display">\[p(x_3) = y_3,\]</span> kde <span class="math inline">\(p(x)\)</span> je hledaný polynom. Dosadíme-li do našeho polynomu hodnotu <span class="math inline">\(x_3\)</span>, dostaneme <span class="math display">\[(x_3-x_0)(x_3-x_1)(x_3-x_2).\]</span> Můžeme nyní podělit náš původní polynom tímto výrazem (který je ale pouze číslo, není tu žádná neznámá). <span class="math display">\[\frac{(x-x_0)(x-x_1)(x-x_2)}{(x_3-x_0)(x_3-x_1)(x_3-x_2)}\]</span> Tento polynom, který je stále stupně <span class="math inline">\(n-1\)</span>, má ve všech našich budech hodnotu 0, tedy kromě bodu <span class="math inline">\(x_3\)</span>, kde má hodnotu 1. Tento polynom už stačí pouze dovést k cíli vynásobením hodnotou <span class="math inline">\(y_3\)</span>. Máme tak polynom <span class="math display">\[p(x) = y_3 \frac{(x-x_0)(x-x_1)(x-x_2)}{(x_3-x_0)(x_3-x_1)(x_3-x_2)}.\]</span> Tento polynom zcela jistě splňuje podmínku <span class="math display">\[p(x_3) = y_3.\]</span></p>
<p>Tento postup bychom mohli zopakovat pro každý bod, tedy vymyslet tímto způsobem polynom, který bude procházet jedním bodem a v ostatních bodech budou procházet osou <span class="math inline">\(x\)</span>.</p>
<p>Tento postup lze vyjádřit i jedním vzorcem, a to <span class="math display">\[\sum_{i=0}^n y_i \prod_{\substack{m=0 \\ m\neq i}}^n \frac{x-x_m}{x_i-x_m}.\]</span></p>
<p>Všimněme si, že produkt nám nahrazuje zlomek a nesmí se v něm probíhající index rovnat indexu předchozí sumy, jelikož by se nám ve jmenovateli objevila 0. Suma nám tak dá kombinace polynomů pro každý bod. Důležité je, že tento výraz generuje i kombinace podílu s jinou hodnotou <span class="math inline">\(y_i\)</span>, což není ku škodě, neboť každý takový součin má hodnotu rovnou 0.</p>
<section id="lagrangeův-interpolační-polynom-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="lagrangeův-interpolační-polynom-v-jazyce-r">Lagrangeův interpolační polynom v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vstupy </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># libovolně si uprav m a data x, y</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>m</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkce</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>Lagrange<span class="ot">&lt;-</span><span class="cf">function</span>(t,x,y){</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  soucet<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>    soucin<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(j<span class="sc">!=</span>i) soucin<span class="ot">&lt;-</span>soucin<span class="sc">*</span>(t<span class="sc">-</span>x[j])<span class="sc">/</span>(x[i]<span class="sc">-</span>x[j])</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>    soucet<span class="ot">&lt;-</span>soucet<span class="sc">+</span>y[i]<span class="sc">*</span>soucin</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(soucet)</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Test funkčnosti</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== TEST: P(x_k) ≈ y_k ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== TEST: P(x_k) ≈ y_k ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  pk <span class="ot">&lt;-</span> <span class="fu">Lagrange</span>(x[k], x, y)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"k=%2d, x=%.3f, P(x)=%.6f, y=%.6f, chyba=%.2e</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>              k, x[k], pk, y[k], <span class="fu">abs</span>(pk <span class="sc">-</span> y[k])))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k= 1, x=1.000, P(x)=0.770352, y=0.770352, chyba=0.00e+00
k= 2, x=2.000, P(x)=0.020692, y=0.020692, chyba=0.00e+00
k= 3, x=3.000, P(x)=0.767689, y=0.767689, chyba=0.00e+00
k= 4, x=4.000, P(x)=0.290143, y=0.290143, chyba=0.00e+00
k= 5, x=5.000, P(x)=-0.437864, y=-0.437864, chyba=0.00e+00
k= 6, x=6.000, P(x)=0.759040, y=0.759040, chyba=0.00e+00
k= 7, x=7.000, P(x)=0.538588, y=0.538588, chyba=0.00e+00
k= 8, x=8.000, P(x)=0.129686, y=0.129686, chyba=0.00e+00
k= 9, x=9.000, P(x)=0.247203, y=0.247203, chyba=0.00e+00
k=10, x=10.000, P(x)=-0.234066, y=-0.234066, chyba=0.00e+00</code></pre>
</div>
</div>
</section>
</section>
<section id="interpolace-polynomem-v-newtonově-tvaru" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="interpolace-polynomem-v-newtonově-tvaru"><span class="header-section-number">4.4</span> Interpolace polynomem v Newtonově tvaru</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="https://geo.mff.cuni.cz/~lh/nofy056/prednaska/02-NR.pdf">Numerické recepty</a> na straně 4,</li>
<li><a href="https://mi21.vsb.cz/sites/mi21.vsb.cz/files/unit/numericke_metody.pdf">Numerické metody I</a> na straně 114-115.</li>
</ul>
<p>Interaktivní vizualizace metody:</p>
<ul>
<li><a href="https://www.geogebra.org/m/rn2fyjeh">Newtonova interpolace</a>.</li>
</ul>
</div>
</div>
</div>
<p>Interpolační polynom v Lagrangeově tvaru má značnou nevýhodu, chceme-li totiž přidat další bod, který by interpolaci zpřesnil, musíme celý polynom přepočítat. Zároveň je tento výpočet dost náročný. Proto je výhodné hledat jiný interpolační polynom.</p>
<p>Takovým vhodným tvarem je polynom, který nazýváme Newtonovým interpolačním polynomem. <span class="math display">\[
N(x) = a_0+a_1(x-x_0)+a_2(x-x_0)(x-x_1) + \cdots + a_n(x-x_0)(x-x_1)\cdots (x-x_{n-1})
\]</span> <span class="math inline">\(N(x)\)</span> je vlastně označením funkce, která proloží dané body <span class="math inline">\(X_0, X_1, \cdots, X_n\)</span> a můžeme tento zápis rozepsat do soustavy rovnic tak, že dosadíme body <span class="math inline">\(X_i[x_i,y_i]\)</span>, přičemž v <span class="math inline">\(i\)</span>-té rovnici zůstane na pravé straně <span class="math inline">\(i+1\)</span> nevynulovaných členů.</p>
<p><span class="math display">\[
\begin{aligned}
y_0 &amp;= a_0\\
y_1 &amp;= a_0 + a_1(x-x_0)\\
y_2 &amp;= a_0 + a_1(x-x_0) + a_2(x-x_0)(x-x_1)\\
&amp;\vdots\\
y_n &amp;= a_0 + a_1(x-x_0) + a_2(x-x_0)(x-x_1) + \cdots + a_n(x-x_0)(x-x_1)\cdots(x-x_{n-1})
\end{aligned}
\]</span> Z tohoto vyjádření pak stačí shora postupně dosazovat vypočtené koeficienty <span class="math inline">\(a_0, a_1, \cdots\)</span> do rovnic níže a dopočítávat další koeficienty. Tímto způsobem je pak možné jednoduše dopočítat další, později přidaný, bod, jelikož předchozí koeficienty známe a nemusíme je přepočítávat.</p>
<p>Pro výpočet koeficientů <span class="math inline">\(a_i\)</span> pak používáme jeho vyjádření z rovnice <span class="math display">\[
a_n = \frac{a_0 + \sum_{i=1}^n a_i \prod_{j=0}^{i-1} (x_n-x_j)}{\prod_{j=0}^{n-1}(x_n-x_j)}.
\]</span></p>
<section id="newtonův-interpolační-polynom-v-jazyce-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="newtonův-interpolační-polynom-v-jazyce-r">Newtonův interpolační polynom v jazyce R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># vykreslení bodů</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co"># popisky souřadnic ke každému bodu</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x, y <span class="sc">+</span> <span class="fl">0.25</span>, <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, x, <span class="st">","</span>, y, <span class="st">")"</span>), <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="NUM_public_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Newtonův interpolační polynom</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>NewtonPolynomialAdd <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, a, i){</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>) <span class="fu">return</span>(y[i]) </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">2</span>) <span class="fu">return</span>((y[<span class="dv">2</span>]<span class="sc">-</span>y[<span class="dv">1</span>])<span class="sc">/</span>(x[<span class="dv">2</span>]<span class="sc">-</span>x[<span class="dv">1</span>]))</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  nasobitko <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  suma <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>)){</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    suma <span class="ot">&lt;-</span> suma <span class="sc">+</span> a[j]<span class="sc">*</span>nasobitko</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>    nasobitko <span class="ot">&lt;-</span> nasobitko<span class="sc">*</span>(x[i]<span class="sc">-</span>x[j])</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((y[i] <span class="sc">-</span> suma)<span class="sc">/</span>nasobitko)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="co"># výpočet všech koeficientů</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">NewtonPolynomialAdd</span>(x, y, a, i)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2.0000000  1.0000000  0.5000000 -0.6666667  0.2500000</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="aproximace-metodou-nejmenších-čtverců" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Aproximace metodou nejmenších čtverců</h1>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/Numerika.pdf">Numerické metody</a> na stranách 69-,</li>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/numerickemetody.pdf">Numerické metody</a> na stranách 124-,</li>
<li><a href="https://physics.ujep.cz/~jskvor/NME/DalsiSkripta/FINALNI_VERZE_CD.pdf">Numerické metody</a> na stranách 108-.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="numerické-derivování-a-integrace" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Numerické derivování a integrace</h1>
<section id="newtonovy-cotesovy-vzorce" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="newtonovy-cotesovy-vzorce"><span class="header-section-number">6.1</span> Newtonovy-Cotesovy vzorce</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="">DOPLNIT</a>.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="rombergova-kvadratura" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="rombergova-kvadratura"><span class="header-section-number">6.2</span> Rombergova kvadratura</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="">DOPLNIT</a>.</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="numerické-řešení-obyčejných-diferenciálních-rovnic" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Numerické řešení obyčejných diferenciálních rovnic</h1>
<section id="eulerova-metoda" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="eulerova-metoda"><span class="header-section-number">7.1</span> Eulerova metoda</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="">DOPLNIT</a>.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="metody-rungeho-kutty" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="metody-rungeho-kutty"><span class="header-section-number">7.2</span> Metody Rungeho-Kutty</h2>
<div class="callout callout-style-simple callout-none no-icon" style="border-left-color: #8B4513">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-body-container callout-body">
<p><img src="book.png" width="20px"><b><span style="padding-left: 10px; font-size: 15px; padding-top: 20px">Zdroj</span></b></p>
</div>
<p>V následujících materiálech naleznete další možná vysvětlení této metody:</p>
<ul>
<li><a href="">DOPLNIT</a>.</li>
</ul>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>